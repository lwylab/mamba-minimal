2025-03-08 00:15:50,157 - INFO - 使用设备: cpu
2025-03-08 00:15:50,158 - INFO - 输出目录: mamba2_results_20250308_001550
2025-03-08 00:15:50,158 - INFO - 加载数据: ./ai4i2020.csv
2025-03-08 00:16:29,287 - INFO - 使用设备: cpu
2025-03-08 00:16:29,287 - INFO - 输出目录: mamba2_results_20250308_001629
2025-03-08 00:16:29,287 - INFO - 加载数据: .../ai4i2020.csv
2025-03-08 00:16:49,747 - INFO - 使用设备: cpu
2025-03-08 00:16:49,748 - INFO - 输出目录: mamba2_results_20250308_001649
2025-03-08 00:16:49,748 - INFO - 加载数据: ..../ai4i2020.csv
2025-03-08 00:17:13,349 - INFO - 使用设备: cpu
2025-03-08 00:17:13,350 - INFO - 输出目录: mamba2_results_20250308_001713
2025-03-08 00:17:13,350 - INFO - 加载数据: C:\Users\L\PycharmProjects\20250227\mamba-minimal\ai4i2020.csv
2025-03-08 00:17:13,372 - INFO - 数据集形状: (10000, 14)
2025-03-08 00:17:13,372 - INFO - 数据集列: ['UDI', 'Product ID', 'Type', 'Air temperature [K]', 'Process temperature [K]', 'Rotational speed [rpm]', 'Torque [Nm]', 'Tool wear [min]', 'Machine failure', 'TWF', 'HDF', 'PWF', 'OSF', 'RNF']
2025-03-08 00:17:13,385 - INFO - 特征工程完成
2025-03-08 00:17:13,388 - INFO - 故障类型映射: {0: '无故障', 1: 'HDF', 2: 'PWF', 3: 'OSF', 4: 'TWF', 5: 'RNF'}
2025-03-08 00:17:13,389 - INFO - 故障类型分布:
Fault_Type
0    9652
1     106
2      83
3      95
4      45
5      19
Name: count, dtype: int64
2025-03-08 00:17:13,396 - INFO - 特征数量: 16
2025-03-08 00:17:13,396 - INFO - 特征列表: ['Air temperature [K]', 'Process temperature [K]', 'Rotational speed [rpm]', 'Torque [Nm]', 'Tool wear [min]', 'Type_encoded', 'Temp_diff', 'Torque_Rotational_ratio', 'Power', 'Tool_wear_rate', 'Temp_Tool_interaction', 'Rotation_Tool_interaction', 'Torque_Tool_interaction', 'Rotational_speed_squared', 'Tool_wear_squared', 'Torque_squared']
2025-03-08 00:17:13,446 - INFO - 类别权重: tensor([ 0.2590, 15.6863, 20.2020, 17.5439, 37.0370, 88.8889])
2025-03-08 00:17:13,446 - INFO - 执行过采样...
2025-03-08 00:17:13,461 - INFO - 过采样后的样本分布: [7722 6177 6177 6177 6177 6177]
2025-03-08 00:17:15,812 - INFO - 模型结构:
Mamba2SequenceModel(
  (input_proj): Linear(in_features=16, out_features=128, bias=True)
  (mamba2): Mamba2(
    (layers): ModuleList(
      (0-3): 4 x Mamba2Block(
        (norm1): RMSNorm()
        (norm2): RMSNorm()
        (ssm): SimplifiedSSM(
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (ff): FeedForward(
          (net): Sequential(
            (0): Linear(in_features=128, out_features=256, bias=True)
            (1): SiLU()
            (2): Dropout(p=0.1, inplace=False)
            (3): Linear(in_features=256, out_features=128, bias=True)
            (4): Dropout(p=0.1, inplace=False)
          )
        )
      )
    )
  )
  (norm_f): RMSNorm()
  (classifier): Linear(in_features=128, out_features=6, bias=True)
)
2025-03-08 00:17:15,813 - INFO - 开始训练模型...
2025-03-08 00:22:11,405 - INFO - 使用设备: cpu
2025-03-08 00:22:11,406 - INFO - 输出目录: mamba2_results_20250308_002211
2025-03-08 00:22:11,406 - INFO - 加载数据: C:\Users\L\PycharmProjects\20250227\mamba-minimal\ai4i2020.csv
2025-03-08 00:22:11,430 - INFO - 数据集形状: (10000, 14)
2025-03-08 00:22:11,430 - INFO - 数据集列: ['UDI', 'Product ID', 'Type', 'Air temperature [K]', 'Process temperature [K]', 'Rotational speed [rpm]', 'Torque [Nm]', 'Tool wear [min]', 'Machine failure', 'TWF', 'HDF', 'PWF', 'OSF', 'RNF']
2025-03-08 00:22:11,444 - INFO - 特征工程完成
2025-03-08 00:22:11,448 - INFO - 故障类型映射: {0: '无故障', 1: 'HDF', 2: 'PWF', 3: 'OSF', 4: 'TWF', 5: 'RNF'}
2025-03-08 00:22:11,449 - INFO - 故障类型分布:
Fault_Type
0    9652
1     106
2      83
3      95
4      45
5      19
Name: count, dtype: int64
2025-03-08 00:22:11,452 - INFO - 特征数量: 16
2025-03-08 00:22:11,452 - INFO - 特征列表: ['Air temperature [K]', 'Process temperature [K]', 'Rotational speed [rpm]', 'Torque [Nm]', 'Tool wear [min]', 'Type_encoded', 'Temp_diff', 'Torque_Rotational_ratio', 'Power', 'Tool_wear_rate', 'Temp_Tool_interaction', 'Rotation_Tool_interaction', 'Torque_Tool_interaction', 'Rotational_speed_squared', 'Tool_wear_squared', 'Torque_squared']
2025-03-08 00:22:11,472 - INFO - 类别权重: tensor([ 0.2590, 15.6863, 20.2020, 17.5439, 37.0370, 88.8889])
2025-03-08 00:22:11,472 - INFO - 执行过采样...
2025-03-08 00:22:11,483 - INFO - 过采样后的样本分布: [7722  170  132  152   72   30]
2025-03-08 00:22:12,095 - INFO - 模型结构:
Mamba2SequenceModel(
  (input_proj): Linear(in_features=16, out_features=128, bias=True)
  (mamba2): Mamba2(
    (layers): ModuleList(
      (0-3): 4 x Mamba2Block(
        (norm1): RMSNorm()
        (norm2): RMSNorm()
        (ssm): SimplifiedSSM(
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (ff): FeedForward(
          (net): Sequential(
            (0): Linear(in_features=128, out_features=256, bias=True)
            (1): SiLU()
            (2): Dropout(p=0.1, inplace=False)
            (3): Linear(in_features=256, out_features=128, bias=True)
            (4): Dropout(p=0.1, inplace=False)
          )
        )
      )
    )
  )
  (norm_f): RMSNorm()
  (classifier): Linear(in_features=128, out_features=6, bias=True)
)
2025-03-08 00:22:12,096 - INFO - 开始训练模型...
2025-03-08 00:25:06,785 - INFO - 使用设备: cpu
2025-03-08 00:25:06,785 - INFO - 输出目录: mamba2_results_20250308_002506
2025-03-08 00:25:06,786 - INFO - 加载数据: C:\Users\L\PycharmProjects\20250227\mamba-minimal\ai4i2020.csv
2025-03-08 00:25:06,806 - INFO - 数据集形状: (10000, 14)
2025-03-08 00:25:06,806 - INFO - 数据集列: ['UDI', 'Product ID', 'Type', 'Air temperature [K]', 'Process temperature [K]', 'Rotational speed [rpm]', 'Torque [Nm]', 'Tool wear [min]', 'Machine failure', 'TWF', 'HDF', 'PWF', 'OSF', 'RNF']
2025-03-08 00:25:06,813 - INFO - 特征工程完成
2025-03-08 00:25:06,816 - INFO - 故障类型映射: {0: '无故障', 1: 'HDF', 2: 'PWF', 3: 'OSF', 4: 'TWF', 5: 'RNF'}
2025-03-08 00:25:06,817 - INFO - 故障类型分布:
Fault_Type
0    9652
1     106
2      83
3      95
4      45
5      19
Name: count, dtype: int64
2025-03-08 00:25:06,822 - INFO - 特征数量: 16
2025-03-08 00:25:06,822 - INFO - 特征列表: ['Air temperature [K]', 'Process temperature [K]', 'Rotational speed [rpm]', 'Torque [Nm]', 'Tool wear [min]', 'Type_encoded', 'Temp_diff', 'Torque_Rotational_ratio', 'Power', 'Tool_wear_rate', 'Temp_Tool_interaction', 'Rotation_Tool_interaction', 'Torque_Tool_interaction', 'Rotational_speed_squared', 'Tool_wear_squared', 'Torque_squared']
2025-03-08 00:25:06,848 - INFO - 类别权重: tensor([ 0.2590, 15.6863, 20.2020, 17.5439, 37.0370, 88.8889])
2025-03-08 00:25:06,848 - INFO - 执行过采样...
2025-03-08 00:25:06,860 - INFO - 过采样后的样本分布: [7722  170  132  152   72   30]
2025-03-08 00:25:07,504 - INFO - 模型结构:
Mamba2SequenceModel(
  (input_proj): Linear(in_features=16, out_features=128, bias=True)
  (mamba2): Mamba2(
    (layers): ModuleList(
      (0-3): 4 x Mamba2Block(
        (norm1): RMSNorm()
        (norm2): RMSNorm()
        (ssm): SimplifiedSSM(
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (ff): FeedForward(
          (net): Sequential(
            (0): Linear(in_features=128, out_features=256, bias=True)
            (1): SiLU()
            (2): Dropout(p=0.1, inplace=False)
            (3): Linear(in_features=256, out_features=128, bias=True)
            (4): Dropout(p=0.1, inplace=False)
          )
        )
      )
    )
  )
  (norm_f): RMSNorm()
  (classifier): Linear(in_features=128, out_features=6, bias=True)
)
2025-03-08 00:25:07,505 - INFO - 开始训练模型...
2025-03-08 00:25:29,766 - INFO - Epoch 1/200 - Loss: 0.5067, Accuracy: 0.3200, F1: 0.4492, Precision: 0.9667, Recall: 0.3200
2025-03-08 00:25:29,774 - INFO - 保存最佳模型，F1: 0.4492
2025-03-08 00:25:48,840 - INFO - Epoch 2/200 - Loss: 0.3690, Accuracy: 0.3455, F1: 0.4800, Precision: 0.9660, Recall: 0.3455
2025-03-08 00:25:48,851 - INFO - 保存最佳模型，F1: 0.4800
2025-03-08 00:26:09,735 - INFO - Epoch 3/200 - Loss: 0.3373, Accuracy: 0.2950, F1: 0.4205, Precision: 0.9676, Recall: 0.2950
2025-03-08 00:26:09,737 - INFO - F1未提升，早停计数器: 1/20
2025-03-08 00:26:31,059 - INFO - Epoch 4/200 - Loss: 0.2990, Accuracy: 0.2120, F1: 0.3121, Precision: 0.9684, Recall: 0.2120
2025-03-08 00:26:31,061 - INFO - F1未提升，早停计数器: 2/20
2025-03-08 00:26:50,557 - INFO - Epoch 5/200 - Loss: 0.2921, Accuracy: 0.3850, F1: 0.5245, Precision: 0.9685, Recall: 0.3850
2025-03-08 00:26:50,566 - INFO - 保存最佳模型，F1: 0.5245
2025-03-08 00:27:18,163 - INFO - Epoch 6/200 - Loss: 0.2572, Accuracy: 0.5655, F1: 0.6934, Precision: 0.9675, Recall: 0.5655
2025-03-08 00:27:18,171 - INFO - 保存最佳模型，F1: 0.6934
2025-03-08 00:27:37,606 - INFO - Epoch 7/200 - Loss: 0.2661, Accuracy: 0.4380, F1: 0.5795, Precision: 0.9690, Recall: 0.4380
2025-03-08 00:27:37,606 - INFO - F1未提升，早停计数器: 1/20
2025-03-08 00:27:56,928 - INFO - Epoch 8/200 - Loss: 0.2570, Accuracy: 0.4460, F1: 0.5856, Precision: 0.9676, Recall: 0.4460
2025-03-08 00:27:56,929 - INFO - F1未提升，早停计数器: 2/20
2025-03-08 00:28:13,980 - INFO - Epoch 9/200 - Loss: 0.2727, Accuracy: 0.4695, F1: 0.6094, Precision: 0.9671, Recall: 0.4695
2025-03-08 00:28:13,980 - INFO - F1未提升，早停计数器: 3/20
2025-03-08 00:28:29,122 - INFO - Epoch 10/200 - Loss: 0.2513, Accuracy: 0.4910, F1: 0.6295, Precision: 0.9681, Recall: 0.4910
2025-03-08 00:28:29,123 - INFO - F1未提升，早停计数器: 4/20
2025-03-08 00:28:45,713 - INFO - Epoch 11/200 - Loss: 0.2544, Accuracy: 0.4655, F1: 0.6055, Precision: 0.9680, Recall: 0.4655
2025-03-08 00:28:45,713 - INFO - F1未提升，早停计数器: 5/20
2025-03-08 00:29:01,571 - INFO - Epoch 12/200 - Loss: 0.2632, Accuracy: 0.4350, F1: 0.5757, Precision: 0.9684, Recall: 0.4350
2025-03-08 00:29:01,572 - INFO - F1未提升，早停计数器: 6/20
2025-03-08 00:29:17,125 - INFO - Epoch 13/200 - Loss: 0.2479, Accuracy: 0.4210, F1: 0.5638, Precision: 0.9698, Recall: 0.4210
2025-03-08 00:29:17,125 - INFO - F1未提升，早停计数器: 7/20
2025-03-08 00:29:32,390 - INFO - Epoch 14/200 - Loss: 0.2435, Accuracy: 0.2770, F1: 0.3987, Precision: 0.9680, Recall: 0.2770
2025-03-08 00:29:32,390 - INFO - F1未提升，早停计数器: 8/20
2025-03-08 00:29:48,797 - INFO - Epoch 15/200 - Loss: 0.2275, Accuracy: 0.2970, F1: 0.4277, Precision: 0.9690, Recall: 0.2970
2025-03-08 00:29:48,798 - INFO - F1未提升，早停计数器: 9/20
2025-03-08 00:30:14,329 - INFO - Epoch 16/200 - Loss: 0.2162, Accuracy: 0.3685, F1: 0.5072, Precision: 0.9685, Recall: 0.3685
2025-03-08 00:30:14,329 - INFO - F1未提升，早停计数器: 10/20
2025-03-08 00:30:34,197 - INFO - Epoch 17/200 - Loss: 0.2201, Accuracy: 0.4360, F1: 0.5780, Precision: 0.9691, Recall: 0.4360
2025-03-08 00:30:34,197 - INFO - F1未提升，早停计数器: 11/20
2025-03-08 00:30:53,188 - INFO - Epoch 18/200 - Loss: 0.2081, Accuracy: 0.4035, F1: 0.5437, Precision: 0.9685, Recall: 0.4035
2025-03-08 00:30:53,188 - INFO - F1未提升，早停计数器: 12/20
2025-03-08 00:31:09,423 - INFO - Epoch 19/200 - Loss: 0.2283, Accuracy: 0.4105, F1: 0.5512, Precision: 0.9687, Recall: 0.4105
2025-03-08 00:31:09,423 - INFO - F1未提升，早停计数器: 13/20
2025-03-08 00:31:25,289 - INFO - Epoch 20/200 - Loss: 0.2104, Accuracy: 0.4345, F1: 0.5747, Precision: 0.9681, Recall: 0.4345
2025-03-08 00:31:25,290 - INFO - F1未提升，早停计数器: 14/20
2025-03-08 00:31:41,775 - INFO - Epoch 21/200 - Loss: 0.2144, Accuracy: 0.4735, F1: 0.6130, Precision: 0.9676, Recall: 0.4735
2025-03-08 00:31:41,776 - INFO - F1未提升，早停计数器: 15/20
2025-03-08 00:31:58,001 - INFO - Epoch 22/200 - Loss: 0.1883, Accuracy: 0.4715, F1: 0.6117, Precision: 0.9687, Recall: 0.4715
2025-03-08 00:31:58,001 - INFO - F1未提升，早停计数器: 16/20
2025-03-08 00:32:13,525 - INFO - Epoch 23/200 - Loss: 0.1910, Accuracy: 0.5320, F1: 0.6658, Precision: 0.9686, Recall: 0.5320
2025-03-08 00:32:13,525 - INFO - F1未提升，早停计数器: 17/20
2025-03-08 00:32:29,492 - INFO - Epoch 24/200 - Loss: 0.2172, Accuracy: 0.5270, F1: 0.6617, Precision: 0.9679, Recall: 0.5270
2025-03-08 00:32:29,493 - INFO - F1未提升，早停计数器: 18/20
2025-03-08 00:32:45,659 - INFO - Epoch 25/200 - Loss: 0.1814, Accuracy: 0.5605, F1: 0.6913, Precision: 0.9691, Recall: 0.5605
2025-03-08 00:32:45,659 - INFO - F1未提升，早停计数器: 19/20
2025-03-08 00:33:00,869 - INFO - Epoch 26/200 - Loss: 0.2324, Accuracy: 0.4845, F1: 0.6235, Precision: 0.9687, Recall: 0.4845
2025-03-08 00:33:00,870 - INFO - F1未提升，早停计数器: 20/20
2025-03-08 00:33:00,870 - INFO - 早停触发，停止训练
2025-03-08 00:33:00,874 - INFO - 开始评估模型...
2025-03-08 00:33:01,060 - INFO - 测试集评估结果:
2025-03-08 00:33:01,060 - INFO - 准确率: 0.4845
2025-03-08 00:33:01,060 - INFO - F1分数: 0.6235
2025-03-08 00:33:01,060 - INFO - 精确率: 0.9687
2025-03-08 00:33:01,061 - INFO - 召回率: 0.4845
2025-03-08 00:33:01,073 - INFO - 分类报告:
              precision    recall  f1-score   support

         无故障       1.00      0.47      0.64      1930
         HDF       0.10      1.00      0.18        21
         PWF       0.12      0.94      0.21        17
         OSF       0.16      1.00      0.28        19
         TWF       0.02      0.56      0.04         9
         RNF       0.00      0.25      0.01         4

    accuracy                           0.48      2000
   macro avg       0.23      0.70      0.22      2000
weighted avg       0.97      0.48      0.62      2000

2025-03-08 00:33:03,212 - INFO - 评估结果已保存到: mamba2_results_20250308_002506\evaluation_results.json
2025-03-08 00:33:03,213 - INFO - 模型训练与评估完成
2025-03-08 00:36:37,145 - INFO - 使用设备: cpu
2025-03-08 00:36:37,146 - INFO - 输出目录: mamba2_results_20250308_003637
2025-03-08 00:36:37,146 - INFO - 加载数据: C:\Users\L\PycharmProjects\20250227\mamba-minimal\ai4i2020.csv
2025-03-08 00:36:37,170 - INFO - 数据集形状: (10000, 14)
2025-03-08 00:36:37,170 - INFO - 数据集列: ['UDI', 'Product ID', 'Type', 'Air temperature [K]', 'Process temperature [K]', 'Rotational speed [rpm]', 'Torque [Nm]', 'Tool wear [min]', 'Machine failure', 'TWF', 'HDF', 'PWF', 'OSF', 'RNF']
2025-03-08 00:36:37,184 - INFO - 特征工程完成
2025-03-08 00:36:37,187 - INFO - 故障类型映射: {0: '无故障', 1: 'HDF', 2: 'PWF', 3: 'OSF'}
2025-03-08 00:36:37,189 - INFO - 故障类型分布:
Fault_Type
0    9713
1     106
2      83
3      98
Name: count, dtype: int64
2025-03-08 00:36:37,192 - INFO - 特征数量: 16
2025-03-08 00:36:37,192 - INFO - 特征列表: ['Air temperature [K]', 'Process temperature [K]', 'Rotational speed [rpm]', 'Torque [Nm]', 'Tool wear [min]', 'Type_encoded', 'Temp_diff', 'Torque_Rotational_ratio', 'Power', 'Tool_wear_rate', 'Temp_Tool_interaction', 'Rotation_Tool_interaction', 'Torque_Tool_interaction', 'Rotational_speed_squared', 'Tool_wear_squared', 'Torque_squared']
2025-03-08 00:36:37,212 - INFO - 类别权重: tensor([ 0.3861, 23.5294, 30.3030, 25.6410])
2025-03-08 00:36:37,212 - INFO - 执行过采样...
2025-03-08 00:36:37,218 - INFO - 过采样后的样本分布: [7771  170  132  156]
2025-03-08 00:36:37,810 - INFO - 模型结构:
Mamba2SequenceModel(
  (input_proj): Linear(in_features=16, out_features=128, bias=True)
  (mamba2): Mamba2(
    (layers): ModuleList(
      (0-3): 4 x Mamba2Block(
        (norm1): RMSNorm()
        (norm2): RMSNorm()
        (ssm): SimplifiedSSM(
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (ff): FeedForward(
          (net): Sequential(
            (0): Linear(in_features=128, out_features=256, bias=True)
            (1): SiLU()
            (2): Dropout(p=0.1, inplace=False)
            (3): Linear(in_features=256, out_features=128, bias=True)
            (4): Dropout(p=0.1, inplace=False)
          )
        )
      )
    )
  )
  (norm_f): RMSNorm()
  (classifier): Linear(in_features=128, out_features=4, bias=True)
)
2025-03-08 00:36:37,810 - INFO - 开始训练模型...
2025-03-08 00:36:58,590 - INFO - Epoch 1/200 - Loss: 0.2232, Accuracy: 0.6605, F1: 0.7710, Precision: 0.9731, Recall: 0.6605
2025-03-08 00:36:58,597 - INFO - 保存最佳模型，F1: 0.7710
2025-03-08 00:37:15,694 - INFO - Epoch 2/200 - Loss: 0.1432, Accuracy: 0.6115, F1: 0.7330, Precision: 0.9730, Recall: 0.6115
2025-03-08 00:37:15,694 - INFO - F1未提升，早停计数器: 1/20
2025-03-08 00:37:37,274 - INFO - Epoch 3/200 - Loss: 0.1266, Accuracy: 0.6265, F1: 0.7455, Precision: 0.9731, Recall: 0.6265
2025-03-08 00:37:37,274 - INFO - F1未提升，早停计数器: 2/20
2025-03-08 00:38:07,119 - INFO - Epoch 4/200 - Loss: 0.0931, Accuracy: 0.6885, F1: 0.7920, Precision: 0.9744, Recall: 0.6885
2025-03-08 00:38:07,128 - INFO - 保存最佳模型，F1: 0.7920
2025-03-08 00:38:27,724 - INFO - Epoch 5/200 - Loss: 0.1257, Accuracy: 0.5925, F1: 0.7184, Precision: 0.9732, Recall: 0.5925
2025-03-08 00:38:27,724 - INFO - F1未提升，早停计数器: 1/20
2025-03-08 00:38:52,012 - INFO - Epoch 6/200 - Loss: 0.1176, Accuracy: 0.7270, F1: 0.8183, Precision: 0.9736, Recall: 0.7270
2025-03-08 00:38:52,021 - INFO - 保存最佳模型，F1: 0.8183
2025-03-08 00:39:18,455 - INFO - Epoch 7/200 - Loss: 0.0996, Accuracy: 0.7005, F1: 0.7988, Precision: 0.9737, Recall: 0.7005
2025-03-08 00:39:18,455 - INFO - F1未提升，早停计数器: 1/20
2025-03-08 00:39:41,735 - INFO - Epoch 8/200 - Loss: 0.1077, Accuracy: 0.6945, F1: 0.7954, Precision: 0.9735, Recall: 0.6945
2025-03-08 00:39:41,735 - INFO - F1未提升，早停计数器: 2/20
2025-03-08 00:40:03,861 - INFO - Epoch 9/200 - Loss: 0.0928, Accuracy: 0.7865, F1: 0.8583, Precision: 0.9746, Recall: 0.7865
2025-03-08 00:40:03,870 - INFO - 保存最佳模型，F1: 0.8583
2025-03-08 00:40:32,897 - INFO - Epoch 10/200 - Loss: 0.0972, Accuracy: 0.7280, F1: 0.8185, Precision: 0.9737, Recall: 0.7280
2025-03-08 00:40:32,898 - INFO - F1未提升，早停计数器: 1/20
2025-03-08 00:40:54,688 - INFO - Epoch 11/200 - Loss: 0.1012, Accuracy: 0.7840, F1: 0.8561, Precision: 0.9746, Recall: 0.7840
2025-03-08 00:40:54,688 - INFO - F1未提升，早停计数器: 2/20
2025-03-08 00:41:20,426 - INFO - Epoch 12/200 - Loss: 0.0873, Accuracy: 0.8180, F1: 0.8785, Precision: 0.9751, Recall: 0.8180
2025-03-08 00:41:20,434 - INFO - 保存最佳模型，F1: 0.8785
2025-03-08 00:41:42,871 - INFO - Epoch 13/200 - Loss: 0.1039, Accuracy: 0.8195, F1: 0.8792, Precision: 0.9753, Recall: 0.8195
2025-03-08 00:41:42,879 - INFO - 保存最佳模型，F1: 0.8792
2025-03-08 00:42:06,133 - INFO - Epoch 14/200 - Loss: 0.0946, Accuracy: 0.8445, F1: 0.8945, Precision: 0.9755, Recall: 0.8445
2025-03-08 00:42:06,140 - INFO - 保存最佳模型，F1: 0.8945
2025-03-08 00:42:26,366 - INFO - Epoch 15/200 - Loss: 0.0818, Accuracy: 0.7410, F1: 0.8280, Precision: 0.9740, Recall: 0.7410
2025-03-08 00:42:26,367 - INFO - F1未提升，早停计数器: 1/20
2025-03-08 00:42:43,181 - INFO - Epoch 16/200 - Loss: 0.0903, Accuracy: 0.7135, F1: 0.8094, Precision: 0.9745, Recall: 0.7135
2025-03-08 00:42:43,182 - INFO - F1未提升，早停计数器: 2/20
2025-03-08 00:43:05,323 - INFO - Epoch 17/200 - Loss: 0.0978, Accuracy: 0.7770, F1: 0.8525, Precision: 0.9745, Recall: 0.7770
2025-03-08 00:43:05,323 - INFO - F1未提升，早停计数器: 3/20
2025-03-08 00:43:22,048 - INFO - Epoch 18/200 - Loss: 0.0968, Accuracy: 0.7620, F1: 0.8424, Precision: 0.9742, Recall: 0.7620
2025-03-08 00:43:22,048 - INFO - F1未提升，早停计数器: 4/20
2025-03-08 00:43:38,872 - INFO - Epoch 19/200 - Loss: 0.0860, Accuracy: 0.7075, F1: 0.8051, Precision: 0.9742, Recall: 0.7075
2025-03-08 00:43:38,874 - INFO - F1未提升，早停计数器: 5/20
2025-03-08 00:43:55,664 - INFO - Epoch 20/200 - Loss: 0.0791, Accuracy: 0.8115, F1: 0.8750, Precision: 0.9752, Recall: 0.8115
2025-03-08 00:43:55,664 - INFO - F1未提升，早停计数器: 6/20
2025-03-08 00:44:10,274 - INFO - Epoch 21/200 - Loss: 0.0959, Accuracy: 0.7685, F1: 0.8470, Precision: 0.9745, Recall: 0.7685
2025-03-08 00:44:10,274 - INFO - F1未提升，早停计数器: 7/20
2025-03-08 00:44:24,913 - INFO - Epoch 22/200 - Loss: 0.0933, Accuracy: 0.6830, F1: 0.7884, Precision: 0.9739, Recall: 0.6830
2025-03-08 00:44:24,913 - INFO - F1未提升，早停计数器: 8/20
2025-03-08 00:44:40,153 - INFO - Epoch 23/200 - Loss: 0.0886, Accuracy: 0.8025, F1: 0.8685, Precision: 0.9745, Recall: 0.8025
2025-03-08 00:44:40,153 - INFO - F1未提升，早停计数器: 9/20
2025-03-08 00:44:55,422 - INFO - Epoch 24/200 - Loss: 0.0781, Accuracy: 0.8235, F1: 0.8824, Precision: 0.9753, Recall: 0.8235
2025-03-08 00:44:55,423 - INFO - F1未提升，早停计数器: 10/20
2025-03-08 00:45:09,940 - INFO - Epoch 25/200 - Loss: 0.0782, Accuracy: 0.8410, F1: 0.8932, Precision: 0.9759, Recall: 0.8410
2025-03-08 00:45:09,940 - INFO - F1未提升，早停计数器: 11/20
2025-03-08 00:45:25,307 - INFO - Epoch 26/200 - Loss: 0.0847, Accuracy: 0.8210, F1: 0.8803, Precision: 0.9748, Recall: 0.8210
2025-03-08 00:45:25,307 - INFO - F1未提升，早停计数器: 12/20
2025-03-08 00:45:42,711 - INFO - Epoch 27/200 - Loss: 0.0677, Accuracy: 0.8160, F1: 0.8771, Precision: 0.9751, Recall: 0.8160
2025-03-08 00:45:42,712 - INFO - F1未提升，早停计数器: 13/20
2025-03-08 00:45:58,712 - INFO - Epoch 28/200 - Loss: 0.0771, Accuracy: 0.8370, F1: 0.8906, Precision: 0.9753, Recall: 0.8370
2025-03-08 00:45:58,712 - INFO - F1未提升，早停计数器: 14/20
2025-03-08 00:46:12,991 - INFO - Epoch 29/200 - Loss: 0.0754, Accuracy: 0.8330, F1: 0.8879, Precision: 0.9751, Recall: 0.8330
2025-03-08 00:46:12,991 - INFO - F1未提升，早停计数器: 15/20
2025-03-08 00:46:27,564 - INFO - Epoch 30/200 - Loss: 0.0744, Accuracy: 0.8245, F1: 0.8826, Precision: 0.9751, Recall: 0.8245
2025-03-08 00:46:27,564 - INFO - F1未提升，早停计数器: 16/20
2025-03-08 00:46:42,601 - INFO - Epoch 31/200 - Loss: 0.0634, Accuracy: 0.8110, F1: 0.8740, Precision: 0.9747, Recall: 0.8110
2025-03-08 00:46:42,603 - INFO - F1未提升，早停计数器: 17/20
2025-03-08 00:46:58,278 - INFO - Epoch 32/200 - Loss: 0.0865, Accuracy: 0.8335, F1: 0.8881, Precision: 0.9754, Recall: 0.8335
2025-03-08 00:46:58,278 - INFO - F1未提升，早停计数器: 18/20
2025-03-08 00:47:14,097 - INFO - Epoch 33/200 - Loss: 0.0874, Accuracy: 0.7735, F1: 0.8505, Precision: 0.9745, Recall: 0.7735
2025-03-08 00:47:14,097 - INFO - F1未提升，早停计数器: 19/20
2025-03-08 00:47:29,515 - INFO - Epoch 34/200 - Loss: 0.0860, Accuracy: 0.8175, F1: 0.8779, Precision: 0.9750, Recall: 0.8175
2025-03-08 00:47:29,515 - INFO - F1未提升，早停计数器: 20/20
2025-03-08 00:47:29,515 - INFO - 早停触发，停止训练
2025-03-08 00:47:29,517 - INFO - 开始评估模型...
2025-03-08 00:47:29,704 - INFO - 测试集评估结果:
2025-03-08 00:47:29,704 - INFO - 准确率: 0.8175
2025-03-08 00:47:29,704 - INFO - F1分数: 0.8779
2025-03-08 00:47:29,704 - INFO - 精确率: 0.9750
2025-03-08 00:47:29,704 - INFO - 召回率: 0.8175
2025-03-08 00:47:29,718 - INFO - 分类报告:
              precision    recall  f1-score   support

         无故障       1.00      0.81      0.90      1942
         HDF       0.11      1.00      0.20        21
         PWF       0.13      1.00      0.23        17
         OSF       0.17      0.90      0.29        20

    accuracy                           0.82      2000
   macro avg       0.35      0.93      0.41      2000
weighted avg       0.98      0.82      0.88      2000

2025-03-08 00:47:31,572 - INFO - 评估结果已保存到: mamba2_results_20250308_003637\evaluation_results.json
2025-03-08 00:47:31,573 - INFO - 模型训练与评估完成
2025-03-08 00:57:38,516 - INFO - 使用设备: cpu
2025-03-08 00:57:38,516 - INFO - 输出目录: mamba2_results_20250308_005738
2025-03-08 00:57:38,516 - INFO - 加载数据: C:\Users\L\PycharmProjects\20250227\mamba-minimal\ai4i2020.csv
2025-03-08 00:57:38,539 - INFO - 数据集形状: (10000, 14)
2025-03-08 00:57:38,539 - INFO - 数据集列: ['UDI', 'Product ID', 'Type', 'Air temperature [K]', 'Process temperature [K]', 'Rotational speed [rpm]', 'Torque [Nm]', 'Tool wear [min]', 'Machine failure', 'TWF', 'HDF', 'PWF', 'OSF', 'RNF']
2025-03-08 00:57:38,548 - INFO - 特征工程完成
2025-03-08 00:57:38,551 - INFO - 故障类型映射: {0: '无故障', 1: 'HDF', 2: 'PWF', 3: 'OSF'}
2025-03-08 00:57:38,553 - INFO - 故障类型分布:
Fault_Type
0    9713
1     106
2      83
3      98
Name: count, dtype: int64
2025-03-08 00:57:38,557 - INFO - 特征数量: 16
2025-03-08 00:57:38,557 - INFO - 特征列表: ['Air temperature [K]', 'Process temperature [K]', 'Rotational speed [rpm]', 'Torque [Nm]', 'Tool wear [min]', 'Type_encoded', 'Temp_diff', 'Torque_Rotational_ratio', 'Power', 'Tool_wear_rate', 'Temp_Tool_interaction', 'Rotation_Tool_interaction', 'Torque_Tool_interaction', 'Rotational_speed_squared', 'Tool_wear_squared', 'Torque_squared']
2025-03-08 00:57:38,582 - INFO - 类别权重: tensor([0.5147, 1.2868, 1.2868, 1.2868])
2025-03-08 00:57:38,582 - INFO - 执行过采样...
2025-03-08 00:57:38,590 - INFO - 过采样后的样本分布: [7771  127   99  117]
2025-03-08 00:57:39,196 - INFO - 模型结构:
Mamba2SequenceModel(
  (input_proj): Linear(in_features=16, out_features=128, bias=True)
  (mamba2): Mamba2(
    (layers): ModuleList(
      (0-3): 4 x Mamba2Block(
        (norm1): RMSNorm()
        (norm2): RMSNorm()
        (ssm): SimplifiedSSM(
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (ff): FeedForward(
          (net): Sequential(
            (0): Linear(in_features=128, out_features=256, bias=True)
            (1): SiLU()
            (2): Dropout(p=0.1, inplace=False)
            (3): Linear(in_features=256, out_features=128, bias=True)
            (4): Dropout(p=0.1, inplace=False)
          )
        )
      )
    )
  )
  (norm_f): RMSNorm()
  (classifier): Linear(in_features=128, out_features=4, bias=True)
)
2025-03-08 00:57:39,196 - INFO - 开始训练模型...
2025-03-08 00:58:01,860 - INFO - Epoch 1/200 - Loss: 0.0121, Accuracy: 0.9425, F1: 0.9561, Precision: 0.9792, Recall: 0.9425
2025-03-08 00:58:01,872 - INFO - 保存最佳模型，F1: 0.9561
2025-03-08 00:58:20,603 - INFO - Epoch 2/200 - Loss: 0.0078, Accuracy: 0.9410, F1: 0.9553, Precision: 0.9797, Recall: 0.9410
2025-03-08 00:58:20,603 - INFO - F1未提升，早停计数器: 1/20
2025-03-08 00:58:36,635 - INFO - Epoch 3/200 - Loss: 0.0071, Accuracy: 0.9470, F1: 0.9596, Precision: 0.9811, Recall: 0.9470
2025-03-08 00:58:36,642 - INFO - 保存最佳模型，F1: 0.9596
2025-03-08 00:58:53,448 - INFO - Epoch 4/200 - Loss: 0.0064, Accuracy: 0.9530, F1: 0.9628, Precision: 0.9801, Recall: 0.9530
2025-03-08 00:58:53,453 - INFO - 保存最佳模型，F1: 0.9628
2025-03-08 00:59:08,981 - INFO - Epoch 5/200 - Loss: 0.0073, Accuracy: 0.9505, F1: 0.9621, Precision: 0.9815, Recall: 0.9505
2025-03-08 00:59:08,982 - INFO - F1未提升，早停计数器: 1/20
2025-03-08 00:59:24,571 - INFO - Epoch 6/200 - Loss: 0.0069, Accuracy: 0.9455, F1: 0.9586, Precision: 0.9810, Recall: 0.9455
2025-03-08 00:59:24,572 - INFO - F1未提升，早停计数器: 2/20
2025-03-08 00:59:40,018 - INFO - Epoch 7/200 - Loss: 0.0062, Accuracy: 0.9610, F1: 0.9679, Precision: 0.9806, Recall: 0.9610
2025-03-08 00:59:40,029 - INFO - 保存最佳模型，F1: 0.9679
2025-03-08 00:59:57,041 - INFO - Epoch 8/200 - Loss: 0.0064, Accuracy: 0.9605, F1: 0.9678, Precision: 0.9817, Recall: 0.9605
2025-03-08 00:59:57,041 - INFO - F1未提升，早停计数器: 1/20
2025-03-08 01:00:15,944 - INFO - Epoch 9/200 - Loss: 0.0068, Accuracy: 0.9620, F1: 0.9688, Precision: 0.9811, Recall: 0.9620
2025-03-08 01:00:15,951 - INFO - 保存最佳模型，F1: 0.9688
2025-03-08 01:00:31,995 - INFO - Epoch 10/200 - Loss: 0.0062, Accuracy: 0.9285, F1: 0.9474, Precision: 0.9788, Recall: 0.9285
2025-03-08 01:00:31,995 - INFO - F1未提升，早停计数器: 1/20
2025-03-08 01:00:48,336 - INFO - Epoch 11/200 - Loss: 0.0056, Accuracy: 0.9470, F1: 0.9589, Precision: 0.9806, Recall: 0.9470
2025-03-08 01:00:48,336 - INFO - F1未提升，早停计数器: 2/20
2025-03-08 01:01:03,559 - INFO - Epoch 12/200 - Loss: 0.0057, Accuracy: 0.9510, F1: 0.9612, Precision: 0.9795, Recall: 0.9510
2025-03-08 01:01:03,559 - INFO - F1未提升，早停计数器: 3/20
2025-03-08 01:01:18,450 - INFO - Epoch 13/200 - Loss: 0.0057, Accuracy: 0.9650, F1: 0.9714, Precision: 0.9833, Recall: 0.9650
2025-03-08 01:01:18,459 - INFO - 保存最佳模型，F1: 0.9714
2025-03-08 01:01:33,789 - INFO - Epoch 14/200 - Loss: 0.0058, Accuracy: 0.9595, F1: 0.9672, Precision: 0.9812, Recall: 0.9595
2025-03-08 01:01:33,790 - INFO - F1未提升，早停计数器: 1/20
2025-03-08 01:01:50,048 - INFO - Epoch 15/200 - Loss: 0.0059, Accuracy: 0.9355, F1: 0.9529, Precision: 0.9814, Recall: 0.9355
2025-03-08 01:01:50,049 - INFO - F1未提升，早停计数器: 2/20
2025-03-08 01:02:05,281 - INFO - Epoch 16/200 - Loss: 0.0058, Accuracy: 0.9670, F1: 0.9722, Precision: 0.9820, Recall: 0.9670
2025-03-08 01:02:05,288 - INFO - 保存最佳模型，F1: 0.9722
2025-03-08 01:02:20,972 - INFO - Epoch 17/200 - Loss: 0.0052, Accuracy: 0.9610, F1: 0.9682, Precision: 0.9816, Recall: 0.9610
2025-03-08 01:02:20,972 - INFO - F1未提升，早停计数器: 1/20
2025-03-08 01:02:38,900 - INFO - Epoch 18/200 - Loss: 0.0057, Accuracy: 0.9695, F1: 0.9746, Precision: 0.9845, Recall: 0.9695
2025-03-08 01:02:38,908 - INFO - 保存最佳模型，F1: 0.9746
2025-03-08 01:03:03,441 - INFO - Epoch 19/200 - Loss: 0.0053, Accuracy: 0.9710, F1: 0.9753, Precision: 0.9840, Recall: 0.9710
2025-03-08 01:03:03,448 - INFO - 保存最佳模型，F1: 0.9753
2025-03-08 01:03:21,379 - INFO - Epoch 20/200 - Loss: 0.0057, Accuracy: 0.9685, F1: 0.9737, Precision: 0.9833, Recall: 0.9685
2025-03-08 01:03:21,379 - INFO - F1未提升，早停计数器: 1/20
2025-03-08 01:03:38,608 - INFO - Epoch 21/200 - Loss: 0.0052, Accuracy: 0.9720, F1: 0.9758, Precision: 0.9828, Recall: 0.9720
2025-03-08 01:03:38,618 - INFO - 保存最佳模型，F1: 0.9758
2025-03-08 01:03:55,326 - INFO - Epoch 22/200 - Loss: 0.0056, Accuracy: 0.9600, F1: 0.9676, Precision: 0.9805, Recall: 0.9600
2025-03-08 01:03:55,326 - INFO - F1未提升，早停计数器: 1/20
2025-03-08 01:04:10,532 - INFO - Epoch 23/200 - Loss: 0.0058, Accuracy: 0.9715, F1: 0.9756, Precision: 0.9836, Recall: 0.9715
2025-03-08 01:04:10,532 - INFO - F1未提升，早停计数器: 2/20
2025-03-08 01:04:26,119 - INFO - Epoch 24/200 - Loss: 0.0051, Accuracy: 0.9665, F1: 0.9721, Precision: 0.9825, Recall: 0.9665
2025-03-08 01:04:26,119 - INFO - F1未提升，早停计数器: 3/20
2025-03-08 01:04:41,412 - INFO - Epoch 25/200 - Loss: 0.0055, Accuracy: 0.9575, F1: 0.9661, Precision: 0.9823, Recall: 0.9575
2025-03-08 01:04:41,412 - INFO - F1未提升，早停计数器: 4/20
2025-03-08 01:04:57,420 - INFO - Epoch 26/200 - Loss: 0.0044, Accuracy: 0.9680, F1: 0.9728, Precision: 0.9818, Recall: 0.9680
2025-03-08 01:04:57,420 - INFO - F1未提升，早停计数器: 5/20
2025-03-08 01:05:12,938 - INFO - Epoch 27/200 - Loss: 0.0051, Accuracy: 0.9620, F1: 0.9691, Precision: 0.9820, Recall: 0.9620
2025-03-08 01:05:12,938 - INFO - F1未提升，早停计数器: 6/20
2025-03-08 01:05:28,601 - INFO - Epoch 28/200 - Loss: 0.0053, Accuracy: 0.9585, F1: 0.9669, Precision: 0.9829, Recall: 0.9585
2025-03-08 01:05:28,601 - INFO - F1未提升，早停计数器: 7/20
2025-03-08 01:05:44,200 - INFO - Epoch 29/200 - Loss: 0.0049, Accuracy: 0.9715, F1: 0.9756, Precision: 0.9831, Recall: 0.9715
2025-03-08 01:05:44,200 - INFO - F1未提升，早停计数器: 8/20
2025-03-08 01:05:59,394 - INFO - Epoch 30/200 - Loss: 0.0054, Accuracy: 0.9725, F1: 0.9760, Precision: 0.9826, Recall: 0.9725
2025-03-08 01:05:59,403 - INFO - 保存最佳模型，F1: 0.9760
2025-03-08 01:06:14,685 - INFO - Epoch 31/200 - Loss: 0.0055, Accuracy: 0.9530, F1: 0.9630, Precision: 0.9811, Recall: 0.9530
2025-03-08 01:06:14,685 - INFO - F1未提升，早停计数器: 1/20
2025-03-08 01:06:30,624 - INFO - Epoch 32/200 - Loss: 0.0056, Accuracy: 0.9690, F1: 0.9736, Precision: 0.9822, Recall: 0.9690
2025-03-08 01:06:30,624 - INFO - F1未提升，早停计数器: 2/20
2025-03-08 01:06:46,896 - INFO - Epoch 33/200 - Loss: 0.0052, Accuracy: 0.9780, F1: 0.9804, Precision: 0.9851, Recall: 0.9780
2025-03-08 01:06:46,904 - INFO - 保存最佳模型，F1: 0.9804
2025-03-08 01:07:02,377 - INFO - Epoch 34/200 - Loss: 0.0052, Accuracy: 0.9730, F1: 0.9768, Precision: 0.9844, Recall: 0.9730
2025-03-08 01:07:02,377 - INFO - F1未提升，早停计数器: 1/20
2025-03-08 01:07:17,654 - INFO - Epoch 35/200 - Loss: 0.0059, Accuracy: 0.9660, F1: 0.9717, Precision: 0.9814, Recall: 0.9660
2025-03-08 01:07:17,654 - INFO - F1未提升，早停计数器: 2/20
2025-03-08 01:07:32,695 - INFO - Epoch 36/200 - Loss: 0.0046, Accuracy: 0.9710, F1: 0.9753, Precision: 0.9835, Recall: 0.9710
2025-03-08 01:07:32,695 - INFO - F1未提升，早停计数器: 3/20
2025-03-08 01:07:49,923 - INFO - Epoch 37/200 - Loss: 0.0056, Accuracy: 0.9740, F1: 0.9780, Precision: 0.9859, Recall: 0.9740
2025-03-08 01:07:49,924 - INFO - F1未提升，早停计数器: 4/20
2025-03-08 01:08:05,017 - INFO - Epoch 38/200 - Loss: 0.0053, Accuracy: 0.9685, F1: 0.9736, Precision: 0.9831, Recall: 0.9685
2025-03-08 01:08:05,017 - INFO - F1未提升，早停计数器: 5/20
2025-03-08 01:08:20,632 - INFO - Epoch 39/200 - Loss: 0.0052, Accuracy: 0.9605, F1: 0.9676, Precision: 0.9801, Recall: 0.9605
2025-03-08 01:08:20,633 - INFO - F1未提升，早停计数器: 6/20
2025-03-08 01:08:35,884 - INFO - Epoch 40/200 - Loss: 0.0054, Accuracy: 0.9725, F1: 0.9765, Precision: 0.9841, Recall: 0.9725
2025-03-08 01:08:35,884 - INFO - F1未提升，早停计数器: 7/20
2025-03-08 01:08:52,831 - INFO - Epoch 41/200 - Loss: 0.0053, Accuracy: 0.9455, F1: 0.9582, Precision: 0.9810, Recall: 0.9455
2025-03-08 01:08:52,831 - INFO - F1未提升，早停计数器: 8/20
2025-03-08 01:09:08,103 - INFO - Epoch 42/200 - Loss: 0.0051, Accuracy: 0.9685, F1: 0.9735, Precision: 0.9833, Recall: 0.9685
2025-03-08 01:09:08,104 - INFO - F1未提升，早停计数器: 9/20
2025-03-08 01:09:23,444 - INFO - Epoch 43/200 - Loss: 0.0053, Accuracy: 0.9705, F1: 0.9751, Precision: 0.9840, Recall: 0.9705
2025-03-08 01:09:23,444 - INFO - F1未提升，早停计数器: 10/20
2025-03-08 01:09:38,510 - INFO - 学习率从 0.0001 调整为 5e-05
2025-03-08 01:09:38,510 - INFO - Epoch 44/200 - Loss: 0.0046, Accuracy: 0.9660, F1: 0.9719, Precision: 0.9829, Recall: 0.9660
2025-03-08 01:09:38,511 - INFO - F1未提升，早停计数器: 11/20
2025-03-08 01:09:54,801 - INFO - Epoch 45/200 - Loss: 0.0042, Accuracy: 0.9690, F1: 0.9741, Precision: 0.9839, Recall: 0.9690
2025-03-08 01:09:54,802 - INFO - F1未提升，早停计数器: 12/20
2025-03-08 01:10:10,571 - INFO - Epoch 46/200 - Loss: 0.0050, Accuracy: 0.9680, F1: 0.9735, Precision: 0.9841, Recall: 0.9680
2025-03-08 01:10:10,572 - INFO - F1未提升，早停计数器: 13/20
2025-03-08 01:10:25,688 - INFO - Epoch 47/200 - Loss: 0.0043, Accuracy: 0.9685, F1: 0.9736, Precision: 0.9836, Recall: 0.9685
2025-03-08 01:10:25,688 - INFO - F1未提升，早停计数器: 14/20
2025-03-08 01:10:40,666 - INFO - Epoch 48/200 - Loss: 0.0050, Accuracy: 0.9670, F1: 0.9725, Precision: 0.9829, Recall: 0.9670
2025-03-08 01:10:40,666 - INFO - F1未提升，早停计数器: 15/20
2025-03-08 01:10:56,540 - INFO - Epoch 49/200 - Loss: 0.0046, Accuracy: 0.9780, F1: 0.9804, Precision: 0.9850, Recall: 0.9780
2025-03-08 01:10:56,540 - INFO - F1未提升，早停计数器: 16/20
2025-03-08 01:11:11,829 - INFO - Epoch 50/200 - Loss: 0.0049, Accuracy: 0.9790, F1: 0.9816, Precision: 0.9869, Recall: 0.9790
2025-03-08 01:11:11,836 - INFO - 保存最佳模型，F1: 0.9816
2025-03-08 01:11:23,252 - INFO - Epoch 51/200 - Loss: 0.0046, Accuracy: 0.9485, F1: 0.9603, Precision: 0.9817, Recall: 0.9485
2025-03-08 01:11:23,252 - INFO - F1未提升，早停计数器: 1/20
2025-03-08 01:11:31,144 - INFO - Epoch 52/200 - Loss: 0.0047, Accuracy: 0.9710, F1: 0.9751, Precision: 0.9827, Recall: 0.9710
2025-03-08 01:11:31,144 - INFO - F1未提升，早停计数器: 2/20
2025-03-08 01:11:39,036 - INFO - Epoch 53/200 - Loss: 0.0043, Accuracy: 0.9760, F1: 0.9791, Precision: 0.9853, Recall: 0.9760
2025-03-08 01:11:39,037 - INFO - F1未提升，早停计数器: 3/20
2025-03-08 01:11:47,190 - INFO - Epoch 54/200 - Loss: 0.0037, Accuracy: 0.9740, F1: 0.9777, Precision: 0.9849, Recall: 0.9740
2025-03-08 01:11:47,190 - INFO - F1未提升，早停计数器: 4/20
2025-03-08 01:11:55,357 - INFO - Epoch 55/200 - Loss: 0.0041, Accuracy: 0.9680, F1: 0.9737, Precision: 0.9848, Recall: 0.9680
2025-03-08 01:11:55,357 - INFO - F1未提升，早停计数器: 5/20
2025-03-08 01:12:03,464 - INFO - Epoch 56/200 - Loss: 0.0051, Accuracy: 0.9705, F1: 0.9747, Precision: 0.9826, Recall: 0.9705
2025-03-08 01:12:03,464 - INFO - F1未提升，早停计数器: 6/20
2025-03-08 01:12:11,432 - INFO - Epoch 57/200 - Loss: 0.0042, Accuracy: 0.9650, F1: 0.9711, Precision: 0.9825, Recall: 0.9650
2025-03-08 01:12:11,432 - INFO - F1未提升，早停计数器: 7/20
2025-03-08 01:12:19,348 - INFO - Epoch 58/200 - Loss: 0.0043, Accuracy: 0.9790, F1: 0.9817, Precision: 0.9872, Recall: 0.9790
2025-03-08 01:12:19,352 - INFO - 保存最佳模型，F1: 0.9817
2025-03-08 01:12:27,280 - INFO - Epoch 59/200 - Loss: 0.0041, Accuracy: 0.9820, F1: 0.9840, Precision: 0.9881, Recall: 0.9820
2025-03-08 01:12:27,288 - INFO - 保存最佳模型，F1: 0.9840
2025-03-08 01:12:35,154 - INFO - Epoch 60/200 - Loss: 0.0046, Accuracy: 0.9690, F1: 0.9741, Precision: 0.9837, Recall: 0.9690
2025-03-08 01:12:35,154 - INFO - F1未提升，早停计数器: 1/20
2025-03-08 01:12:43,229 - INFO - Epoch 61/200 - Loss: 0.0050, Accuracy: 0.9770, F1: 0.9802, Precision: 0.9865, Recall: 0.9770
2025-03-08 01:12:43,229 - INFO - F1未提升，早停计数器: 2/20
2025-03-08 01:12:51,143 - INFO - Epoch 62/200 - Loss: 0.0042, Accuracy: 0.9725, F1: 0.9765, Precision: 0.9843, Recall: 0.9725
2025-03-08 01:12:51,143 - INFO - F1未提升，早停计数器: 3/20
2025-03-08 01:12:59,066 - INFO - Epoch 63/200 - Loss: 0.0042, Accuracy: 0.9740, F1: 0.9775, Precision: 0.9844, Recall: 0.9740
2025-03-08 01:12:59,067 - INFO - F1未提升，早停计数器: 4/20
2025-03-08 01:13:06,897 - INFO - Epoch 64/200 - Loss: 0.0044, Accuracy: 0.9770, F1: 0.9799, Precision: 0.9855, Recall: 0.9770
2025-03-08 01:13:06,898 - INFO - F1未提升，早停计数器: 5/20
2025-03-08 01:13:14,790 - INFO - Epoch 65/200 - Loss: 0.0044, Accuracy: 0.9740, F1: 0.9777, Precision: 0.9851, Recall: 0.9740
2025-03-08 01:13:14,790 - INFO - F1未提升，早停计数器: 6/20
2025-03-08 01:13:22,669 - INFO - Epoch 66/200 - Loss: 0.0043, Accuracy: 0.9700, F1: 0.9745, Precision: 0.9830, Recall: 0.9700
2025-03-08 01:13:22,670 - INFO - F1未提升，早停计数器: 7/20
2025-03-08 01:13:30,540 - INFO - Epoch 67/200 - Loss: 0.0043, Accuracy: 0.9760, F1: 0.9792, Precision: 0.9860, Recall: 0.9760
2025-03-08 01:13:30,540 - INFO - F1未提升，早停计数器: 8/20
2025-03-08 01:13:38,411 - INFO - Epoch 68/200 - Loss: 0.0043, Accuracy: 0.9825, F1: 0.9837, Precision: 0.9860, Recall: 0.9825
2025-03-08 01:13:38,411 - INFO - F1未提升，早停计数器: 9/20
2025-03-08 01:13:46,678 - INFO - Epoch 69/200 - Loss: 0.0040, Accuracy: 0.9770, F1: 0.9799, Precision: 0.9858, Recall: 0.9770
2025-03-08 01:13:46,678 - INFO - F1未提升，早停计数器: 10/20
2025-03-08 01:13:54,533 - INFO - 学习率从 5e-05 调整为 2.5e-05
2025-03-08 01:13:54,533 - INFO - Epoch 70/200 - Loss: 0.0040, Accuracy: 0.9680, F1: 0.9732, Precision: 0.9838, Recall: 0.9680
2025-03-08 01:13:54,533 - INFO - F1未提升，早停计数器: 11/20
2025-03-08 01:14:02,423 - INFO - Epoch 71/200 - Loss: 0.0043, Accuracy: 0.9745, F1: 0.9781, Precision: 0.9855, Recall: 0.9745
2025-03-08 01:14:02,423 - INFO - F1未提升，早停计数器: 12/20
2025-03-08 01:14:10,352 - INFO - Epoch 72/200 - Loss: 0.0047, Accuracy: 0.9760, F1: 0.9791, Precision: 0.9854, Recall: 0.9760
2025-03-08 01:14:10,352 - INFO - F1未提升，早停计数器: 13/20
2025-03-08 01:14:18,255 - INFO - Epoch 73/200 - Loss: 0.0044, Accuracy: 0.9755, F1: 0.9789, Precision: 0.9858, Recall: 0.9755
2025-03-08 01:14:18,255 - INFO - F1未提升，早停计数器: 14/20
2025-03-08 01:14:26,185 - INFO - Epoch 74/200 - Loss: 0.0037, Accuracy: 0.9800, F1: 0.9824, Precision: 0.9875, Recall: 0.9800
2025-03-08 01:14:26,185 - INFO - F1未提升，早停计数器: 15/20
2025-03-08 01:14:34,076 - INFO - Epoch 75/200 - Loss: 0.0036, Accuracy: 0.9775, F1: 0.9804, Precision: 0.9868, Recall: 0.9775
2025-03-08 01:14:34,076 - INFO - F1未提升，早停计数器: 16/20
2025-03-08 01:14:42,073 - INFO - Epoch 76/200 - Loss: 0.0047, Accuracy: 0.9770, F1: 0.9798, Precision: 0.9855, Recall: 0.9770
2025-03-08 01:14:42,073 - INFO - F1未提升，早停计数器: 17/20
2025-03-08 01:14:50,040 - INFO - Epoch 77/200 - Loss: 0.0038, Accuracy: 0.9770, F1: 0.9798, Precision: 0.9854, Recall: 0.9770
2025-03-08 01:14:50,040 - INFO - F1未提升，早停计数器: 18/20
2025-03-08 01:14:57,934 - INFO - Epoch 78/200 - Loss: 0.0043, Accuracy: 0.9740, F1: 0.9777, Precision: 0.9852, Recall: 0.9740
2025-03-08 01:14:57,934 - INFO - F1未提升，早停计数器: 19/20
2025-03-08 01:15:05,966 - INFO - Epoch 79/200 - Loss: 0.0040, Accuracy: 0.9770, F1: 0.9797, Precision: 0.9851, Recall: 0.9770
2025-03-08 01:15:05,966 - INFO - F1未提升，早停计数器: 20/20
2025-03-08 01:15:05,966 - INFO - 早停触发，停止训练
2025-03-08 01:15:05,967 - INFO - 开始评估模型...
