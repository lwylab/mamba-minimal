2025-03-03 01:00:33,881 - INFO - 使用 CPU
2025-03-03 01:00:33,886 - ERROR - 错误：文件未找到，请检查路径 ../ai4i2020.csv
2025-03-03 01:01:51,255 - INFO - 使用 CPU
2025-03-03 01:01:51,374 - INFO - 数据加载成功！
2025-03-03 01:01:51,375 - INFO - 数据集形状: (10000, 14)
2025-03-03 01:01:51,375 - INFO - 数据集列: ['UDI', 'Product ID', 'Type', 'Air temperature [K]', 'Process temperature [K]', 'Rotational speed [rpm]', 'Torque [Nm]', 'Tool wear [min]', 'Machine failure', 'TWF', 'HDF', 'PWF', 'OSF', 'RNF']
2025-03-03 01:01:51,380 - INFO - 添加温差特征
2025-03-03 01:01:51,383 - INFO - 产品类型编码映射: {'H': 0, 'L': 1, 'M': 2}
2025-03-03 01:01:51,387 - INFO - 故障类型映射: {0: '无故障', 1: 'TWF', 2: 'HDF', 3: 'PWF', 4: 'OSF', 5: 'RNF'}
2025-03-03 01:01:51,396 - INFO - 故障类型分布:
Fault_Type
0    9652
1      42
2     106
3      83
4      98
5      19
Name: count, dtype: int64
2025-03-03 01:01:53,963 - INFO - 模型参数总数: 235270
2025-03-03 01:02:01,995 - INFO - Epoch 1/100 | Train Loss: 1.2666 | Val Loss: 0.3648
2025-03-03 01:02:04,528 - INFO - Epoch 2/100 | Train Loss: 0.2015 | Val Loss: 0.1584
2025-03-03 01:02:08,219 - INFO - Epoch 3/100 | Train Loss: 0.1483 | Val Loss: 0.1412
2025-03-03 01:02:10,615 - INFO - Epoch 4/100 | Train Loss: 0.1331 | Val Loss: 0.1280
2025-03-03 01:02:13,990 - INFO - Epoch 5/100 | Train Loss: 0.1204 | Val Loss: 0.1181
2025-03-03 01:02:16,404 - INFO - Epoch 6/100 | Train Loss: 0.1099 | Val Loss: 0.1076
2025-03-03 01:02:18,788 - INFO - Epoch 7/100 | Train Loss: 0.1018 | Val Loss: 0.1007
2025-03-03 01:02:22,238 - INFO - Epoch 8/100 | Train Loss: 0.0922 | Val Loss: 0.0920
2025-03-03 01:02:24,627 - INFO - Epoch 9/100 | Train Loss: 0.0837 | Val Loss: 0.0848
2025-03-03 01:02:26,990 - INFO - Epoch 10/100 | Train Loss: 0.0787 | Val Loss: 0.0781
2025-03-03 01:02:30,263 - INFO - Epoch 11/100 | Train Loss: 0.0723 | Val Loss: 0.0752
2025-03-03 01:02:32,609 - INFO - Epoch 12/100 | Train Loss: 0.0688 | Val Loss: 0.0724
2025-03-03 01:02:35,392 - INFO - Epoch 13/100 | Train Loss: 0.0640 | Val Loss: 0.0706
2025-03-03 01:02:38,277 - INFO - Epoch 14/100 | Train Loss: 0.0625 | Val Loss: 0.0696
2025-03-03 01:02:40,648 - INFO - Epoch 15/100 | Train Loss: 0.0596 | Val Loss: 0.0665
2025-03-03 01:02:43,961 - INFO - Epoch 16/100 | Train Loss: 0.0605 | Val Loss: 0.0726
2025-03-03 01:02:46,380 - INFO - Epoch 17/100 | Train Loss: 0.0582 | Val Loss: 0.0637
2025-03-03 01:02:48,817 - INFO - Epoch 18/100 | Train Loss: 0.0558 | Val Loss: 0.0631
2025-03-03 01:02:52,273 - INFO - Epoch 19/100 | Train Loss: 0.0556 | Val Loss: 0.0626
2025-03-03 01:02:54,643 - INFO - Epoch 20/100 | Train Loss: 0.0536 | Val Loss: 0.0607
2025-03-03 01:02:57,759 - INFO - Epoch 21/100 | Train Loss: 0.0533 | Val Loss: 0.0597
2025-03-03 01:03:00,235 - INFO - Epoch 22/100 | Train Loss: 0.0514 | Val Loss: 0.0586
2025-03-03 01:03:02,641 - INFO - Epoch 23/100 | Train Loss: 0.0507 | Val Loss: 0.0593
2025-03-03 01:03:05,147 - INFO - Epoch 24/100 | Train Loss: 0.0504 | Val Loss: 0.0607
2025-03-03 01:03:07,646 - INFO - Epoch 25/100 | Train Loss: 0.0477 | Val Loss: 0.0600
2025-03-03 01:03:10,057 - INFO - Epoch 26/100 | Train Loss: 0.0492 | Val Loss: 0.0595
2025-03-03 01:03:12,910 - INFO - Epoch 27/100 | Train Loss: 0.0473 | Val Loss: 0.0545
2025-03-03 01:03:15,835 - INFO - Epoch 28/100 | Train Loss: 0.0474 | Val Loss: 0.0551
2025-03-03 01:03:18,206 - INFO - Epoch 29/100 | Train Loss: 0.0461 | Val Loss: 0.0558
2025-03-03 01:03:21,840 - INFO - Epoch 30/100 | Train Loss: 0.0447 | Val Loss: 0.0529
2025-03-03 01:03:24,208 - INFO - Epoch 31/100 | Train Loss: 0.0438 | Val Loss: 0.0619
2025-03-03 01:03:26,637 - INFO - Epoch 32/100 | Train Loss: 0.0457 | Val Loss: 0.0574
2025-03-03 01:03:29,795 - INFO - Epoch 33/100 | Train Loss: 0.0450 | Val Loss: 0.0538
2025-03-03 01:03:32,189 - INFO - Epoch 34/100 | Train Loss: 0.0437 | Val Loss: 0.0565
2025-03-03 01:03:35,576 - INFO - Epoch 35/100 | Train Loss: 0.0436 | Val Loss: 0.0574
2025-03-03 01:03:38,493 - INFO - Epoch 36/100 | Train Loss: 0.0415 | Val Loss: 0.0559
2025-03-03 01:03:40,911 - INFO - Epoch 37/100 | Train Loss: 0.0427 | Val Loss: 0.0583
2025-03-03 01:03:44,594 - INFO - Epoch 38/100 | Train Loss: 0.0403 | Val Loss: 0.0570
2025-03-03 01:03:46,973 - INFO - Epoch 39/100 | Train Loss: 0.0394 | Val Loss: 0.0659
2025-03-03 01:03:49,354 - INFO - Epoch 40/100 | Train Loss: 0.0411 | Val Loss: 0.0577
2025-03-03 01:03:53,072 - INFO - Epoch 41/100 | Train Loss: 0.0404 | Val Loss: 0.0534
2025-03-03 01:03:55,452 - INFO - Epoch 42/100 | Train Loss: 0.0394 | Val Loss: 0.0552
2025-03-03 01:03:58,982 - INFO - Epoch 43/100 | Train Loss: 0.0404 | Val Loss: 0.0632
2025-03-03 01:04:01,466 - INFO - Epoch 44/100 | Train Loss: 0.0380 | Val Loss: 0.0559
2025-03-03 01:04:03,851 - INFO - Epoch 45/100 | Train Loss: 0.0370 | Val Loss: 0.0533
2025-03-03 01:04:07,471 - INFO - Epoch 46/100 | Train Loss: 0.0366 | Val Loss: 0.0570
2025-03-03 01:04:09,846 - INFO - Epoch 47/100 | Train Loss: 0.0370 | Val Loss: 0.0617
2025-03-03 01:04:12,300 - INFO - Epoch 48/100 | Train Loss: 0.0369 | Val Loss: 0.0566
2025-03-03 01:04:15,670 - INFO - Epoch 49/100 | Train Loss: 0.0361 | Val Loss: 0.0602
2025-03-03 01:04:18,046 - INFO - Epoch 50/100 | Train Loss: 0.0381 | Val Loss: 0.0621
2025-03-03 01:04:18,046 - INFO - Early stopping triggered after 50 epochs
2025-03-03 01:04:18,052 - INFO - 最佳模型已保存到 mamba_experiment_results\20250303_010151\best_mamba_model.pth
2025-03-03 01:04:18,555 - INFO - 学习曲线已保存到 mamba_experiment_results\20250303_010151\learning_curves.png
2025-03-03 01:04:18,680 - INFO - 准确率: 0.9827
2025-03-03 01:04:18,680 - INFO - 宏平均F1分数: 0.5608
2025-03-03 01:04:18,680 - INFO - 加权平均F1分数: 0.9797
2025-03-03 01:04:18,749 - INFO - 评估结果已保存到 mamba_experiment_results\20250303_010151\mamba_evaluation_results.json
2025-03-03 01:18:45,641 - INFO - 使用 CPU
2025-03-03 01:18:45,664 - INFO - 数据加载成功！
2025-03-03 01:18:45,664 - INFO - 数据集形状: (10000, 14)
2025-03-03 01:18:45,664 - INFO - 数据集列: ['UDI', 'Product ID', 'Type', 'Air temperature [K]', 'Process temperature [K]', 'Rotational speed [rpm]', 'Torque [Nm]', 'Tool wear [min]', 'Machine failure', 'TWF', 'HDF', 'PWF', 'OSF', 'RNF']
2025-03-03 01:18:45,668 - INFO - 添加温差特征
2025-03-03 01:18:45,669 - INFO - 产品类型编码映射: {'H': 0, 'L': 1, 'M': 2}
2025-03-03 01:18:45,674 - INFO - 故障类型映射: {0: '无故障', 1: 'TWF', 2: 'HDF', 3: 'PWF', 4: 'OSF', 5: 'RNF'}
2025-03-03 01:18:45,679 - INFO - 故障类型分布:
Fault_Type
0    9652
1      42
2     106
3      83
4      98
5      19
Name: count, dtype: int64
2025-03-03 01:18:46,959 - INFO - 模型参数总数: 235270
2025-03-03 01:18:49,440 - INFO - Epoch 1/100 | Train Loss: 1.1744 | Val Loss: 0.2998
2025-03-03 01:18:51,812 - INFO - Epoch 2/100 | Train Loss: 0.1776 | Val Loss: 0.1468
2025-03-03 01:18:54,260 - INFO - Epoch 3/100 | Train Loss: 0.1390 | Val Loss: 0.1333
2025-03-03 01:18:56,837 - INFO - Epoch 4/100 | Train Loss: 0.1250 | Val Loss: 0.1217
2025-03-03 01:18:59,310 - INFO - Epoch 5/100 | Train Loss: 0.1139 | Val Loss: 0.1109
2025-03-03 01:19:01,876 - INFO - Epoch 6/100 | Train Loss: 0.1029 | Val Loss: 0.1014
2025-03-03 01:19:04,297 - INFO - Epoch 7/100 | Train Loss: 0.0919 | Val Loss: 0.0925
2025-03-03 01:19:06,837 - INFO - Epoch 8/100 | Train Loss: 0.0835 | Val Loss: 0.0838
2025-03-03 01:19:09,393 - INFO - Epoch 9/100 | Train Loss: 0.0767 | Val Loss: 0.0800
2025-03-03 01:19:11,908 - INFO - Epoch 10/100 | Train Loss: 0.0712 | Val Loss: 0.0750
2025-03-03 01:19:14,356 - INFO - Epoch 11/100 | Train Loss: 0.0687 | Val Loss: 0.0709
2025-03-03 01:19:16,846 - INFO - Epoch 12/100 | Train Loss: 0.0634 | Val Loss: 0.0738
2025-03-03 01:19:19,279 - INFO - Epoch 13/100 | Train Loss: 0.0618 | Val Loss: 0.0673
2025-03-03 01:19:21,758 - INFO - Epoch 14/100 | Train Loss: 0.0597 | Val Loss: 0.0655
2025-03-03 01:19:24,166 - INFO - Epoch 15/100 | Train Loss: 0.0579 | Val Loss: 0.0626
2025-03-03 01:19:26,644 - INFO - Epoch 16/100 | Train Loss: 0.0570 | Val Loss: 0.0607
2025-03-03 01:19:29,083 - INFO - Epoch 17/100 | Train Loss: 0.0542 | Val Loss: 0.0622
2025-03-03 01:19:31,487 - INFO - Epoch 18/100 | Train Loss: 0.0554 | Val Loss: 0.0601
2025-03-03 01:19:33,957 - INFO - Epoch 19/100 | Train Loss: 0.0545 | Val Loss: 0.0565
2025-03-03 01:19:36,417 - INFO - Epoch 20/100 | Train Loss: 0.0526 | Val Loss: 0.0609
2025-03-03 01:19:38,848 - INFO - Epoch 21/100 | Train Loss: 0.0502 | Val Loss: 0.0631
2025-03-03 01:19:41,251 - INFO - Epoch 22/100 | Train Loss: 0.0499 | Val Loss: 0.0552
2025-03-03 01:19:43,642 - INFO - Epoch 23/100 | Train Loss: 0.0499 | Val Loss: 0.0556
2025-03-03 01:19:46,202 - INFO - Epoch 24/100 | Train Loss: 0.0467 | Val Loss: 0.0588
2025-03-03 01:19:48,643 - INFO - Epoch 25/100 | Train Loss: 0.0502 | Val Loss: 0.0573
2025-03-03 01:19:51,040 - INFO - Epoch 26/100 | Train Loss: 0.0476 | Val Loss: 0.0577
2025-03-03 01:19:53,412 - INFO - Epoch 27/100 | Train Loss: 0.0465 | Val Loss: 0.0566
2025-03-03 01:19:55,813 - INFO - Epoch 28/100 | Train Loss: 0.0455 | Val Loss: 0.0602
2025-03-03 01:19:58,200 - INFO - Epoch 29/100 | Train Loss: 0.0453 | Val Loss: 0.0579
2025-03-03 01:20:00,689 - INFO - Epoch 30/100 | Train Loss: 0.0454 | Val Loss: 0.0541
2025-03-03 01:20:03,087 - INFO - Epoch 31/100 | Train Loss: 0.0441 | Val Loss: 0.0632
2025-03-03 01:20:05,486 - INFO - Epoch 32/100 | Train Loss: 0.0472 | Val Loss: 0.0602
2025-03-03 01:20:07,901 - INFO - Epoch 33/100 | Train Loss: 0.0442 | Val Loss: 0.0593
2025-03-03 01:20:10,329 - INFO - Epoch 34/100 | Train Loss: 0.0460 | Val Loss: 0.0556
2025-03-03 01:20:12,794 - INFO - Epoch 35/100 | Train Loss: 0.0428 | Val Loss: 0.0546
2025-03-03 01:20:15,274 - INFO - Epoch 36/100 | Train Loss: 0.0428 | Val Loss: 0.0613
2025-03-03 01:20:17,808 - INFO - Epoch 37/100 | Train Loss: 0.0464 | Val Loss: 0.0543
2025-03-03 01:20:20,250 - INFO - Epoch 38/100 | Train Loss: 0.0406 | Val Loss: 0.0551
2025-03-03 01:20:22,666 - INFO - Epoch 39/100 | Train Loss: 0.0407 | Val Loss: 0.0542
2025-03-03 01:20:25,038 - INFO - Epoch 40/100 | Train Loss: 0.0429 | Val Loss: 0.0547
2025-03-03 01:20:27,453 - INFO - Epoch 41/100 | Train Loss: 0.0417 | Val Loss: 0.0553
2025-03-03 01:20:29,894 - INFO - Epoch 42/100 | Train Loss: 0.0400 | Val Loss: 0.0544
2025-03-03 01:20:32,311 - INFO - Epoch 43/100 | Train Loss: 0.0408 | Val Loss: 0.0535
2025-03-03 01:20:34,695 - INFO - Epoch 44/100 | Train Loss: 0.0398 | Val Loss: 0.0534
2025-03-03 01:20:37,069 - INFO - Epoch 45/100 | Train Loss: 0.0378 | Val Loss: 0.0532
2025-03-03 01:20:39,468 - INFO - Epoch 46/100 | Train Loss: 0.0364 | Val Loss: 0.0538
2025-03-03 01:20:41,875 - INFO - Epoch 47/100 | Train Loss: 0.0378 | Val Loss: 0.0523
2025-03-03 01:20:44,295 - INFO - Epoch 48/100 | Train Loss: 0.0363 | Val Loss: 0.0589
2025-03-03 01:20:46,692 - INFO - Epoch 49/100 | Train Loss: 0.0386 | Val Loss: 0.0569
2025-03-03 01:20:49,274 - INFO - Epoch 50/100 | Train Loss: 0.0372 | Val Loss: 0.0575
2025-03-03 01:20:51,728 - INFO - Epoch 51/100 | Train Loss: 0.0379 | Val Loss: 0.0557
2025-03-03 01:20:54,269 - INFO - Epoch 52/100 | Train Loss: 0.0372 | Val Loss: 0.0575
2025-03-03 01:20:57,143 - INFO - Epoch 53/100 | Train Loss: 0.0366 | Val Loss: 0.0586
2025-03-03 01:21:00,426 - INFO - Epoch 54/100 | Train Loss: 0.0362 | Val Loss: 0.0582
2025-03-03 01:21:03,282 - INFO - Epoch 55/100 | Train Loss: 0.0348 | Val Loss: 0.0617
2025-03-03 01:21:05,880 - INFO - Epoch 56/100 | Train Loss: 0.0363 | Val Loss: 0.0564
2025-03-03 01:21:08,431 - INFO - Epoch 57/100 | Train Loss: 0.0382 | Val Loss: 0.0694
2025-03-03 01:21:10,939 - INFO - Epoch 58/100 | Train Loss: 0.0398 | Val Loss: 0.0627
2025-03-03 01:21:13,369 - INFO - Epoch 59/100 | Train Loss: 0.0362 | Val Loss: 0.0664
2025-03-03 01:21:15,781 - INFO - Epoch 60/100 | Train Loss: 0.0364 | Val Loss: 0.0597
2025-03-03 01:21:18,212 - INFO - Epoch 61/100 | Train Loss: 0.0344 | Val Loss: 0.0605
2025-03-03 01:21:20,660 - INFO - Epoch 62/100 | Train Loss: 0.0339 | Val Loss: 0.0608
2025-03-03 01:21:23,071 - INFO - Epoch 63/100 | Train Loss: 0.0339 | Val Loss: 0.0582
2025-03-03 01:21:25,548 - INFO - Epoch 64/100 | Train Loss: 0.0371 | Val Loss: 0.0637
2025-03-03 01:21:28,039 - INFO - Epoch 65/100 | Train Loss: 0.0318 | Val Loss: 0.0618
2025-03-03 01:21:30,469 - INFO - Epoch 66/100 | Train Loss: 0.0334 | Val Loss: 0.0619
2025-03-03 01:21:32,874 - INFO - Epoch 67/100 | Train Loss: 0.0335 | Val Loss: 0.0633
2025-03-03 01:21:32,875 - INFO - Early stopping triggered after 67 epochs
2025-03-03 01:21:32,881 - INFO - 最佳模型已保存到 mamba_experiment_results\20250303_011845\best_mamba_model.pth
2025-03-03 01:21:33,405 - INFO - 学习曲线已保存到 mamba_experiment_results\20250303_011845\learning_curves.svg
2025-03-03 01:21:33,524 - INFO - 准确率: 0.9837
2025-03-03 01:21:33,524 - INFO - 宏平均F1分数: 0.5713
2025-03-03 01:21:33,524 - INFO - 加权平均F1分数: 0.9808
2025-03-03 01:21:33,612 - INFO - 评估结果已保存到 mamba_experiment_results\20250303_011845\mamba_evaluation_results.json
2025-03-03 01:21:36,333 - INFO - 特征重要性分析已保存到 mamba_experiment_results\20250303_011845
2025-03-03 01:21:36,334 - INFO - 模型训练与评估完成！
2025-03-03 01:21:36,335 - INFO - 最佳验证损失: 0.0523
2025-03-03 01:21:36,335 - INFO - 准确率: 0.9837
2025-03-03 01:21:36,335 - INFO - 宏平均F1分数: 0.5713
2025-03-03 01:21:36,336 - INFO - 加权平均F1分数: 0.9808
2025-03-03 01:21:36,336 - INFO - 前10个最重要的特征:
2025-03-03 01:21:36,337 - INFO - 1. Process temperature [K]: 0.1867
2025-03-03 01:21:36,337 - INFO - 2. Tool wear [min]: 0.1866
2025-03-03 01:21:36,338 - INFO - 3. Rotational speed [rpm]: 0.1864
2025-03-03 01:21:36,338 - INFO - 4. Type_encoded: 0.1797
2025-03-03 01:21:36,338 - INFO - 5. Temp_diff: 0.1793
2025-03-03 01:21:36,339 - INFO - 6. Torque [Nm]: 0.1786
2025-03-03 01:21:36,340 - INFO - 7. Air temperature [K]: 0.1693
2025-03-03 01:21:36,340 - INFO - 所有结果已保存到: mamba_experiment_results\20250303_011845
2025-03-07 17:17:39,759 - INFO - 使用 CPU
2025-03-07 17:17:39,760 - INFO - 使用设备: cpu
2025-03-07 17:17:39,780 - INFO - 数据加载成功！
2025-03-07 17:17:39,780 - INFO - 数据集形状: (10000, 14)
2025-03-07 17:17:39,780 - INFO - 数据集列: ['UDI', 'Product ID', 'Type', 'Air temperature [K]', 'Process temperature [K]', 'Rotational speed [rpm]', 'Torque [Nm]', 'Tool wear [min]', 'Machine failure', 'TWF', 'HDF', 'PWF', 'OSF', 'RNF']
2025-03-07 17:17:39,786 - INFO - 添加高级工程特征完成
2025-03-07 17:17:39,789 - INFO - 产品类型编码映射: {'H': 0, 'L': 1, 'M': 2}
2025-03-07 17:17:39,792 - INFO - 故障类型映射: {0: '无故障', 1: 'HDF', 2: 'PWF', 3: 'OSF', 4: 'TWF', 5: 'RNF'}
2025-03-07 17:17:39,796 - INFO - 故障类型分布:
Fault_Type
0    9652
1     106
2      83
3      95
4      45
5      19
Name: count, dtype: int64
2025-03-07 17:17:39,808 - INFO - 类别权重: [1.72675784e-01 1.57232704e+01 2.00803213e+01 1.75438596e+01
 3.70370370e+02 1.75438596e+03]
2025-03-07 17:17:39,826 - INFO - 特征维度: 18
2025-03-07 17:17:39,827 - INFO - 类别数量: 6
2025-03-07 17:17:41,752 - INFO - 模型结构:
MambaFaultPredictionModel(
  (embedding): Sequential(
    (0): Linear(in_features=18, out_features=128, bias=True)
    (1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    (2): GELU(approximate='none')
    (3): Dropout(p=0.2, inplace=False)
  )
  (layers): ModuleList(
    (0-3): 4 x ResidualBlock(
      (mixer): MambaBlock(
        (in_proj): Linear(in_features=128, out_features=512, bias=False)
        (conv1d): Conv1d(256, 256, kernel_size=(4,), stride=(1,), padding=(3,), groups=256)
        (x_proj): Linear(in_features=256, out_features=40, bias=False)
        (dt_proj): Linear(in_features=8, out_features=256, bias=True)
        (out_proj): Linear(in_features=256, out_features=128, bias=False)
      )
      (norm): RMSNorm()
    )
  )
  (norm_f): RMSNorm()
  (classifier): Linear(in_features=128, out_features=6, bias=True)
  (binary_classifier): Sequential(
    (0): Linear(in_features=128, out_features=64, bias=True)
    (1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
    (2): GELU(approximate='none')
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=64, out_features=2, bias=True)
  )
  (twf_classifier): Sequential(
    (0): Linear(in_features=128, out_features=64, bias=True)
    (1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
    (2): GELU(approximate='none')
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=64, out_features=2, bias=True)
  )
  (rnf_classifier): Sequential(
    (0): Linear(in_features=128, out_features=64, bias=True)
    (1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
    (2): GELU(approximate='none')
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=64, out_features=2, bias=True)
  )
)
2025-03-07 17:17:41,752 - INFO - 总参数数量: 495,564
2025-03-07 17:17:41,753 - INFO - 可训练参数数量: 495,564
2025-03-07 17:20:51,980 - INFO - 使用 CPU
2025-03-07 17:20:51,980 - INFO - 使用设备: cpu
2025-03-07 17:20:51,995 - INFO - 数据加载成功！
2025-03-07 17:20:51,995 - INFO - 数据集形状: (10000, 14)
2025-03-07 17:20:51,996 - INFO - 数据集列: ['UDI', 'Product ID', 'Type', 'Air temperature [K]', 'Process temperature [K]', 'Rotational speed [rpm]', 'Torque [Nm]', 'Tool wear [min]', 'Machine failure', 'TWF', 'HDF', 'PWF', 'OSF', 'RNF']
2025-03-07 17:20:52,000 - INFO - 添加高级工程特征完成
2025-03-07 17:20:52,002 - INFO - 产品类型编码映射: {'H': 0, 'L': 1, 'M': 2}
2025-03-07 17:20:52,004 - INFO - 故障类型映射: {0: '无故障', 1: 'HDF', 2: 'PWF', 3: 'OSF', 4: 'TWF', 5: 'RNF'}
2025-03-07 17:20:52,005 - INFO - 故障类型分布:
Fault_Type
0    9652
1     106
2      83
3      95
4      45
5      19
Name: count, dtype: int64
2025-03-07 17:20:52,008 - INFO - 类别权重: [1.72675784e-01 1.57232704e+01 2.00803213e+01 1.75438596e+01
 3.70370370e+02 1.75438596e+03]
2025-03-07 17:20:52,024 - INFO - 特征维度: 18
2025-03-07 17:20:52,024 - INFO - 类别数量: 6
2025-03-07 17:20:56,350 - INFO - 模型结构:
MambaFaultPredictionModel(
  (embedding): Sequential(
    (0): Linear(in_features=18, out_features=128, bias=True)
    (1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    (2): GELU(approximate='none')
    (3): Dropout(p=0.2, inplace=False)
  )
  (layers): ModuleList(
    (0-3): 4 x ResidualBlock(
      (mixer): MambaBlock(
        (in_proj): Linear(in_features=128, out_features=512, bias=False)
        (conv1d): Conv1d(256, 256, kernel_size=(4,), stride=(1,), padding=(3,), groups=256)
        (x_proj): Linear(in_features=256, out_features=40, bias=False)
        (dt_proj): Linear(in_features=8, out_features=256, bias=True)
        (out_proj): Linear(in_features=256, out_features=128, bias=False)
      )
      (norm): RMSNorm()
    )
  )
  (norm_f): RMSNorm()
  (classifier): Linear(in_features=128, out_features=6, bias=True)
  (binary_classifier): Sequential(
    (0): Linear(in_features=128, out_features=64, bias=True)
    (1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
    (2): GELU(approximate='none')
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=64, out_features=2, bias=True)
  )
  (twf_classifier): Sequential(
    (0): Linear(in_features=128, out_features=64, bias=True)
    (1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
    (2): GELU(approximate='none')
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=64, out_features=2, bias=True)
  )
  (rnf_classifier): Sequential(
    (0): Linear(in_features=128, out_features=64, bias=True)
    (1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
    (2): GELU(approximate='none')
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=64, out_features=2, bias=True)
  )
)
2025-03-07 17:20:56,351 - INFO - 总参数数量: 495,564
2025-03-07 17:20:56,351 - INFO - 可训练参数数量: 495,564
2025-03-07 17:20:56,355 - INFO - 模型训练器初始化完成
2025-03-07 17:20:56,363 - INFO - 开始训练，总轮次: 300
2025-03-07 17:21:07,056 - INFO - 当前学习率: 0.001000
2025-03-07 17:21:07,056 - INFO - 轮次 1/300, 训练损失: 1.7109, 验证损失: 1.0530
2025-03-07 17:21:07,070 - INFO - 最佳模型已保存到 mamba_experiment_results\20250307_172051\best_mamba_model.pth
2025-03-07 17:21:20,237 - INFO - 当前学习率: 0.001000
2025-03-07 17:21:20,237 - INFO - 轮次 2/300, 训练损失: 1.1468, 验证损失: 1.6317
2025-03-07 17:21:30,719 - INFO - 当前学习率: 0.001000
2025-03-07 17:21:30,719 - INFO - 轮次 3/300, 训练损失: 1.0462, 验证损失: 0.6483
2025-03-07 17:21:30,728 - INFO - 最佳模型已保存到 mamba_experiment_results\20250307_172051\best_mamba_model.pth
2025-03-07 17:21:41,558 - INFO - 当前学习率: 0.001000
2025-03-07 17:21:41,558 - INFO - 轮次 4/300, 训练损失: 0.8471, 验证损失: 0.7183
2025-03-07 17:22:03,291 - INFO - 当前学习率: 0.001000
2025-03-07 17:22:03,291 - INFO - 轮次 5/300, 训练损失: 0.8434, 验证损失: 0.7066
2025-03-07 17:22:12,212 - INFO - 当前学习率: 0.001000
2025-03-07 17:22:12,212 - INFO - 轮次 6/300, 训练损失: 0.7172, 验证损失: 0.6765
2025-03-07 17:22:22,443 - INFO - 当前学习率: 0.001000
2025-03-07 17:22:22,443 - INFO - 轮次 7/300, 训练损失: 0.8451, 验证损失: 1.8049
2025-03-07 17:22:31,386 - INFO - 当前学习率: 0.001000
2025-03-07 17:22:31,391 - INFO - 轮次 8/300, 训练损失: 0.6195, 验证损失: 0.9749
2025-03-07 17:22:39,900 - INFO - 当前学习率: 0.001000
2025-03-07 17:22:39,900 - INFO - 轮次 9/300, 训练损失: 0.9299, 验证损失: 0.6866
2025-03-07 17:22:49,376 - INFO - 当前学习率: 0.001000
2025-03-07 17:22:49,376 - INFO - 轮次 10/300, 训练损失: 0.8045, 验证损失: 0.9567
2025-03-07 17:23:00,123 - INFO - 当前学习率: 0.001000
2025-03-07 17:23:00,123 - INFO - 轮次 11/300, 训练损失: 0.6269, 验证损失: 1.2893
2025-03-07 17:23:10,830 - INFO - 当前学习率: 0.001000
2025-03-07 17:23:10,831 - INFO - 轮次 12/300, 训练损失: 0.6365, 验证损失: 0.5931
2025-03-07 17:23:10,840 - INFO - 最佳模型已保存到 mamba_experiment_results\20250307_172051\best_mamba_model.pth
2025-03-07 17:23:20,285 - INFO - 当前学习率: 0.001000
2025-03-07 17:23:20,285 - INFO - 轮次 13/300, 训练损失: 0.5218, 验证损失: 0.9843
2025-03-07 17:23:29,841 - INFO - 当前学习率: 0.001000
2025-03-07 17:23:29,841 - INFO - 轮次 14/300, 训练损失: 0.6262, 验证损失: 1.0232
2025-03-07 17:23:41,097 - INFO - 当前学习率: 0.001000
2025-03-07 17:23:41,097 - INFO - 轮次 15/300, 训练损失: 0.8286, 验证损失: 0.9284
2025-03-07 17:23:51,368 - INFO - 当前学习率: 0.001000
2025-03-07 17:23:51,368 - INFO - 轮次 16/300, 训练损失: 0.5780, 验证损失: 0.6219
2025-03-07 17:24:01,556 - INFO - 当前学习率: 0.001000
2025-03-07 17:24:01,557 - INFO - 轮次 17/300, 训练损失: 0.6008, 验证损失: 0.8136
2025-03-07 17:24:11,616 - INFO - 当前学习率: 0.001000
2025-03-07 17:24:11,617 - INFO - 轮次 18/300, 训练损失: 0.6533, 验证损失: 0.6837
2025-03-07 17:24:20,905 - INFO - 当前学习率: 0.001000
2025-03-07 17:24:20,906 - INFO - 轮次 19/300, 训练损失: 0.7156, 验证损失: 1.0428
2025-03-07 17:24:29,841 - INFO - 当前学习率: 0.001000
2025-03-07 17:24:29,841 - INFO - 轮次 20/300, 训练损失: 0.7340, 验证损失: 1.0798
2025-03-07 17:24:38,716 - INFO - 当前学习率: 0.001000
2025-03-07 17:24:38,716 - INFO - 轮次 21/300, 训练损失: 0.7011, 验证损失: 0.8826
2025-03-07 17:24:47,534 - INFO - 当前学习率: 0.001000
2025-03-07 17:24:47,534 - INFO - 轮次 22/300, 训练损失: 0.6926, 验证损失: 0.8446
2025-03-07 17:24:56,472 - INFO - 当前学习率: 0.000500
2025-03-07 17:24:56,472 - INFO - 轮次 23/300, 训练损失: 0.8596, 验证损失: 0.8504
2025-03-07 17:25:05,312 - INFO - 当前学习率: 0.000500
2025-03-07 17:25:05,312 - INFO - 轮次 24/300, 训练损失: 0.7214, 验证损失: 0.9393
2025-03-07 17:25:13,616 - INFO - 当前学习率: 0.000500
2025-03-07 17:25:13,616 - INFO - 轮次 25/300, 训练损失: 0.5273, 验证损失: 0.8906
2025-03-07 17:25:21,920 - INFO - 当前学习率: 0.000500
2025-03-07 17:25:21,920 - INFO - 轮次 26/300, 训练损失: 0.5039, 验证损失: 0.8913
2025-03-07 17:25:30,181 - INFO - 当前学习率: 0.000500
2025-03-07 17:25:30,181 - INFO - 轮次 27/300, 训练损失: 0.5167, 验证损失: 0.9963
2025-03-07 17:25:38,345 - INFO - 当前学习率: 0.000500
2025-03-07 17:25:38,345 - INFO - 轮次 28/300, 训练损失: 0.3453, 验证损失: 1.1646
2025-03-07 17:25:46,816 - INFO - 当前学习率: 0.000500
2025-03-07 17:25:46,816 - INFO - 轮次 29/300, 训练损失: 0.2916, 验证损失: 1.2677
2025-03-07 17:25:55,225 - INFO - 当前学习率: 0.000500
2025-03-07 17:25:55,225 - INFO - 轮次 30/300, 训练损失: 0.2364, 验证损失: 1.4574
2025-03-07 17:26:04,158 - INFO - 当前学习率: 0.000500
2025-03-07 17:26:04,158 - INFO - 轮次 31/300, 训练损失: 0.4591, 验证损失: 1.2618
2025-03-07 17:26:12,477 - INFO - 当前学习率: 0.000500
2025-03-07 17:26:12,477 - INFO - 轮次 32/300, 训练损失: 0.3801, 验证损失: 1.3239
2025-03-07 17:26:20,630 - INFO - 当前学习率: 0.000500
2025-03-07 17:26:20,630 - INFO - 轮次 33/300, 训练损失: 0.3761, 验证损失: 1.3825
2025-03-07 17:26:28,700 - INFO - 当前学习率: 0.000250
2025-03-07 17:26:28,700 - INFO - 轮次 34/300, 训练损失: 0.4013, 验证损失: 0.9409
2025-03-07 17:26:36,852 - INFO - 当前学习率: 0.000250
2025-03-07 17:26:36,852 - INFO - 轮次 35/300, 训练损失: 0.3470, 验证损失: 1.0118
2025-03-07 17:26:45,456 - INFO - 当前学习率: 0.000250
2025-03-07 17:26:45,456 - INFO - 轮次 36/300, 训练损失: 0.3362, 验证损失: 1.0316
2025-03-07 17:26:53,778 - INFO - 当前学习率: 0.000250
2025-03-07 17:26:53,779 - INFO - 轮次 37/300, 训练损失: 0.2902, 验证损失: 1.1794
2025-03-07 17:27:02,463 - INFO - 当前学习率: 0.000250
2025-03-07 17:27:02,464 - INFO - 轮次 38/300, 训练损失: 0.1929, 验证损失: 1.3063
2025-03-07 17:27:11,159 - INFO - 当前学习率: 0.000250
2025-03-07 17:27:11,159 - INFO - 轮次 39/300, 训练损失: 0.2078, 验证损失: 1.3754
2025-03-07 17:27:20,110 - INFO - 当前学习率: 0.000250
2025-03-07 17:27:20,110 - INFO - 轮次 40/300, 训练损失: 0.5409, 验证损失: 1.2312
2025-03-07 17:27:30,591 - INFO - 当前学习率: 0.000250
2025-03-07 17:27:30,592 - INFO - 轮次 41/300, 训练损失: 0.3240, 验证损失: 1.1755
2025-03-07 17:27:40,368 - INFO - 当前学习率: 0.000250
2025-03-07 17:27:40,368 - INFO - 轮次 42/300, 训练损失: 0.2444, 验证损失: 1.2068
2025-03-07 17:27:49,019 - INFO - 当前学习率: 0.000250
2025-03-07 17:27:49,019 - INFO - 轮次 43/300, 训练损失: 0.2478, 验证损失: 1.1808
2025-03-07 17:27:57,713 - INFO - 当前学习率: 0.000250
2025-03-07 17:27:57,713 - INFO - 轮次 44/300, 训练损失: 0.3530, 验证损失: 1.5277
2025-03-07 17:28:06,200 - INFO - 当前学习率: 0.000125
2025-03-07 17:28:06,200 - INFO - 轮次 45/300, 训练损失: 0.3665, 验证损失: 1.1524
2025-03-07 17:28:14,969 - INFO - 当前学习率: 0.000125
2025-03-07 17:28:14,969 - INFO - 轮次 46/300, 训练损失: 0.2366, 验证损失: 1.2082
2025-03-07 17:28:23,619 - INFO - 当前学习率: 0.000125
2025-03-07 17:28:23,619 - INFO - 轮次 47/300, 训练损失: 0.2394, 验证损失: 1.1975
2025-03-07 17:28:32,422 - INFO - 当前学习率: 0.000125
2025-03-07 17:28:32,422 - INFO - 轮次 48/300, 训练损失: 0.2048, 验证损失: 1.2529
2025-03-07 17:28:40,793 - INFO - 当前学习率: 0.000125
2025-03-07 17:28:40,793 - INFO - 轮次 49/300, 训练损失: 0.2208, 验证损失: 1.2683
2025-03-07 17:28:50,895 - INFO - 当前学习率: 0.000125
2025-03-07 17:28:50,895 - INFO - 轮次 50/300, 训练损失: 0.2196, 验证损失: 1.3424
2025-03-07 17:29:00,822 - INFO - 当前学习率: 0.000125
2025-03-07 17:29:00,822 - INFO - 轮次 51/300, 训练损失: 0.2435, 验证损失: 1.1814
2025-03-07 17:29:10,593 - INFO - 当前学习率: 0.000125
2025-03-07 17:29:10,593 - INFO - 轮次 52/300, 训练损失: 0.2391, 验证损失: 1.1287
2025-03-07 17:29:19,773 - INFO - 当前学习率: 0.000125
2025-03-07 17:29:19,773 - INFO - 轮次 53/300, 训练损失: 0.1674, 验证损失: 1.2920
2025-03-07 17:29:30,132 - INFO - 当前学习率: 0.000125
2025-03-07 17:29:30,132 - INFO - 轮次 54/300, 训练损失: 0.2370, 验证损失: 1.5333
2025-03-07 17:29:41,020 - INFO - 当前学习率: 0.000125
2025-03-07 17:29:41,020 - INFO - 轮次 55/300, 训练损失: 0.1495, 验证损失: 1.6087
2025-03-07 17:29:53,556 - INFO - 当前学习率: 0.000063
2025-03-07 17:29:53,556 - INFO - 轮次 56/300, 训练损失: 0.2578, 验证损失: 1.5439
2025-03-07 17:30:07,867 - INFO - 当前学习率: 0.000063
2025-03-07 17:30:07,867 - INFO - 轮次 57/300, 训练损失: 0.2368, 验证损失: 1.3190
2025-03-07 17:30:16,750 - INFO - 当前学习率: 0.000063
2025-03-07 17:30:16,750 - INFO - 轮次 58/300, 训练损失: 0.1934, 验证损失: 1.3220
2025-03-07 17:30:25,025 - INFO - 当前学习率: 0.000063
2025-03-07 17:30:25,025 - INFO - 轮次 59/300, 训练损失: 0.2085, 验证损失: 1.3410
2025-03-07 17:30:33,740 - INFO - 当前学习率: 0.000063
2025-03-07 17:30:33,740 - INFO - 轮次 60/300, 训练损失: 0.4014, 验证损失: 1.3612
2025-03-07 17:30:42,858 - INFO - 当前学习率: 0.000063
2025-03-07 17:30:42,858 - INFO - 轮次 61/300, 训练损失: 0.2648, 验证损失: 1.4235
2025-03-07 17:30:51,715 - INFO - 当前学习率: 0.000063
2025-03-07 17:30:51,715 - INFO - 轮次 62/300, 训练损失: 0.1877, 验证损失: 1.3085
2025-03-07 17:30:51,715 - INFO - 早停触发，共训练 62 轮
2025-03-07 17:30:51,735 - INFO - 加载最佳模型完成
2025-03-07 17:30:51,952 - INFO - 准确率: 0.0223
2025-03-07 17:30:51,952 - INFO - F1分数(宏平均): 0.1250
2025-03-07 17:30:51,953 - INFO - F1分数(加权平均): 0.0068
2025-03-07 17:30:51,967 - INFO - 分类报告:
              precision    recall  f1-score   support

         无故障       0.00      0.00      0.00      2896
         HDF       0.08      0.88      0.15        32
         PWF       0.12      0.64      0.20        25
         OSF       0.47      0.29      0.36        28
         TWF       0.02      0.85      0.04        13
         RNF       0.00      0.67      0.00         6

    accuracy                           0.02      3000
   macro avg       0.12      0.55      0.12      3000
weighted avg       0.01      0.02      0.01      3000

2025-03-07 17:30:51,974 - INFO - 二分类准确率: 0.0347
2025-03-07 17:30:51,974 - INFO - 二分类F1分数: 0.0670
2025-03-07 17:30:51,975 - INFO - 二分类精确率: 0.0347
2025-03-07 17:30:51,975 - INFO - 二分类召回率: 1.0000
2025-03-07 17:30:51,980 - INFO - TWF专用分类器准确率: 0.9957
2025-03-07 17:30:51,981 - INFO - TWF专用分类器F1分数: 0.0000
2025-03-07 17:30:51,981 - INFO - TWF专用分类器精确率: 0.0000
2025-03-07 17:30:51,981 - INFO - TWF专用分类器召回率: 0.0000
2025-03-07 17:30:51,987 - INFO - RNF专用分类器准确率: 0.9980
2025-03-07 17:30:51,987 - INFO - RNF专用分类器F1分数: 0.0000
2025-03-07 17:30:51,987 - INFO - RNF专用分类器精确率: 0.0000
2025-03-07 17:30:51,987 - INFO - RNF专用分类器召回率: 0.0000
2025-03-07 17:30:53,105 - INFO - 评估结果已保存到 mamba_experiment_results\20250307_172051\mamba_evaluation_results.json
2025-03-07 17:30:53,302 - INFO - 训练历史图表已保存到 mamba_experiment_results\20250307_172051\loss_history.svg
2025-03-07 17:30:53,302 - INFO - 训练和评估完成！
2025-03-07 17:30:53,302 - INFO - 最终准确率: 0.0223
2025-03-07 17:30:53,302 - INFO - 最终F1分数(宏平均): 0.1250
2025-03-07 17:30:53,303 - INFO - 最终F1分数(加权平均): 0.0068
2025-03-07 17:30:53,303 - INFO - 二分类F1分数: 0.0670
2025-03-07 17:30:53,303 - INFO - TWF专用分类器F1分数: 0.0000
2025-03-07 17:30:53,303 - INFO - RNF专用分类器F1分数: 0.0000
2025-03-07 17:30:53,304 - INFO - 实验配置已保存到 mamba_experiment_results\20250307_172051\experiment_config.json
