C:\Users\L\PycharmProjects\20250227\mamba-minimal\.venv\Scripts\python.exe C:\Users\L\PycharmProjects\20250227\mamba-minimal\improved_fault_prediction.py
2025-03-07 01:01:42,160 - INFO - 使用 CPU
2025-03-07 01:01:42,161 - INFO - 配置初始化完成
2025-03-07 01:01:42,177 - INFO - 数据加载成功！
2025-03-07 01:01:42,177 - INFO - 数据集形状: (10000, 14)
2025-03-07 01:01:42,177 - INFO - 数据集列: ['UDI', 'Product ID', 'Type', 'Air temperature [K]', 'Process temperature [K]', 'Rotational speed [rpm]', 'Torque [Nm]', 'Tool wear [min]', 'Machine failure', 'TWF', 'HDF', 'PWF', 'OSF', 'RNF']
2025-03-07 01:01:42,180 - INFO - 添加工程特征完成
2025-03-07 01:01:42,182 - INFO - 产品类型编码映射: {'H': 0, 'L': 1, 'M': 2}
2025-03-07 01:01:42,184 - INFO - 故障类型映射: {0: '无故障', 1: 'HDF', 2: 'PWF', 3: 'OSF', 4: 'TWF', 5: 'RNF'}
2025-03-07 01:01:42,186 - INFO - 故障类型分布:
Fault_Type
0    9652
1     106
2      83
3      95
4      45
5      19
Name: count, dtype: int64
2025-03-07 01:01:42,189 - INFO - 类别权重: [ 0.17267578 15.72327044 20.08032129 17.54385965 37.03703704 87.71929825]
2025-03-07 01:01:42,194 - INFO - 应用SMOTE过采样...
2025-03-07 01:01:42,330 - INFO - 过采样后的训练集分布:
Fault_Type
0    6756
1    6756
2    6756
3    6756
4    6756
5    6756
Name: count, dtype: int64
2025-03-07 01:01:42,346 - INFO - 数据处理完成
2025-03-07 01:01:42,353 - INFO - 初始化改进版序列模型，d_model=256, d_state=16
2025-03-07 01:01:42,360 - INFO - 初始化改进版序列模型，d_model=256, d_state=16
2025-03-07 01:01:42,365 - INFO - 初始化改进版序列模型，d_model=256, d_state=16
2025-03-07 01:01:42,372 - INFO - 初始化改进版序列模型，d_model=256, d_state=16
2025-03-07 01:01:42,374 - INFO - 模型创建完成，参数数量: 3265864
C:\Users\L\PycharmProjects\20250227\mamba-minimal\.venv\lib\site-packages\torch\optim\lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
2025-03-07 01:02:16,470 - INFO - Epoch 1/200 | Train Loss: 0.2556 | Val Loss: 2.0118 | LR: 0.001000
2025-03-07 01:02:16,470 - INFO - 发现更好的模型，验证损失: 2.0118
2025-03-07 01:02:46,242 - INFO - Epoch 2/200 | Train Loss: 0.1317 | Val Loss: 1.6599 | LR: 0.001000
2025-03-07 01:02:46,243 - INFO - 发现更好的模型，验证损失: 1.6599
2025-03-07 01:03:16,684 - INFO - Epoch 3/200 | Train Loss: 0.1105 | Val Loss: 1.4844 | LR: 0.001000
2025-03-07 01:03:16,684 - INFO - 发现更好的模型，验证损失: 1.4844
2025-03-07 01:03:47,302 - INFO - Epoch 4/200 | Train Loss: 0.0934 | Val Loss: 1.6588 | LR: 0.001000
2025-03-07 01:04:17,174 - INFO - Epoch 5/200 | Train Loss: 0.0822 | Val Loss: 1.8694 | LR: 0.001000
2025-03-07 01:04:45,892 - INFO - Epoch 6/200 | Train Loss: 0.0782 | Val Loss: 1.7097 | LR: 0.001000
2025-03-07 01:05:15,323 - INFO - Epoch 7/200 | Train Loss: 0.0753 | Val Loss: 1.9532 | LR: 0.001000
2025-03-07 01:05:45,783 - INFO - Epoch 8/200 | Train Loss: 0.0676 | Val Loss: 1.8268 | LR: 0.001000
2025-03-07 01:06:18,359 - INFO - Epoch 9/200 | Train Loss: 0.0689 | Val Loss: 1.8093 | LR: 0.001000
2025-03-07 01:06:53,253 - INFO - Epoch 10/200 | Train Loss: 0.0637 | Val Loss: 1.6715 | LR: 0.001000
2025-03-07 01:07:21,745 - INFO - Epoch 11/200 | Train Loss: 0.0628 | Val Loss: 1.8646 | LR: 0.001000
2025-03-07 01:07:50,314 - INFO - Epoch 12/200 | Train Loss: 0.0568 | Val Loss: 1.7193 | LR: 0.001000
2025-03-07 01:08:18,669 - INFO - Epoch 13/200 | Train Loss: 0.0590 | Val Loss: 1.9876 | LR: 0.001000
2025-03-07 01:08:47,341 - INFO - Epoch 14/200 | Train Loss: 0.0583 | Val Loss: 1.6578 | LR: 0.000500
2025-03-07 01:09:15,727 - INFO - Epoch 15/200 | Train Loss: 0.0437 | Val Loss: 2.0751 | LR: 0.000500
2025-03-07 01:09:44,216 - INFO - Epoch 16/200 | Train Loss: 0.0409 | Val Loss: 1.7981 | LR: 0.000500
2025-03-07 01:10:12,962 - INFO - Epoch 17/200 | Train Loss: 0.0410 | Val Loss: 2.0965 | LR: 0.000500
2025-03-07 01:10:41,256 - INFO - Epoch 18/200 | Train Loss: 0.0394 | Val Loss: 2.3372 | LR: 0.000500
2025-03-07 01:11:09,691 - INFO - Epoch 19/200 | Train Loss: 0.0393 | Val Loss: 1.7015 | LR: 0.000500
2025-03-07 01:11:38,318 - INFO - Epoch 20/200 | Train Loss: 0.0401 | Val Loss: 2.1007 | LR: 0.000500
2025-03-07 01:12:06,905 - INFO - Epoch 21/200 | Train Loss: 0.0377 | Val Loss: 2.5261 | LR: 0.000500
2025-03-07 01:12:34,982 - INFO - Epoch 22/200 | Train Loss: 0.0386 | Val Loss: 2.4167 | LR: 0.000500
2025-03-07 01:13:03,974 - INFO - Epoch 23/200 | Train Loss: 0.0362 | Val Loss: 2.4796 | LR: 0.000500
2025-03-07 01:13:32,023 - INFO - Epoch 24/200 | Train Loss: 0.0356 | Val Loss: 2.5564 | LR: 0.000500
2025-03-07 01:14:00,214 - INFO - Epoch 25/200 | Train Loss: 0.0372 | Val Loss: 2.6250 | LR: 0.000250
2025-03-07 01:14:28,029 - INFO - Epoch 26/200 | Train Loss: 0.0285 | Val Loss: 2.5692 | LR: 0.000250
2025-03-07 01:14:56,145 - INFO - Epoch 27/200 | Train Loss: 0.0282 | Val Loss: 2.2662 | LR: 0.000250
2025-03-07 01:15:24,414 - INFO - Epoch 28/200 | Train Loss: 0.0272 | Val Loss: 2.2253 | LR: 0.000250
2025-03-07 01:15:52,650 - INFO - Epoch 29/200 | Train Loss: 0.0272 | Val Loss: 2.6925 | LR: 0.000250
2025-03-07 01:16:23,353 - INFO - Epoch 30/200 | Train Loss: 0.0276 | Val Loss: 2.6129 | LR: 0.000250
2025-03-07 01:16:49,442 - INFO - Epoch 31/200 | Train Loss: 0.0258 | Val Loss: 2.8079 | LR: 0.000250
2025-03-07 01:17:14,881 - INFO - Epoch 32/200 | Train Loss: 0.0273 | Val Loss: 2.9545 | LR: 0.000250
2025-03-07 01:17:43,783 - INFO - Epoch 33/200 | Train Loss: 0.0261 | Val Loss: 2.3907 | LR: 0.000250
2025-03-07 01:17:43,783 - INFO - 早停触发，在第 33 轮停止训练
2025-03-07 01:17:43,807 - INFO - 最佳模型已保存到 improved_experiment_results\20250307_010142\best_improved_model.pth
2025-03-07 01:17:43,809 - INFO - 模型训练完成
2025-03-07 01:17:44,244 - INFO - 准确率: 0.8493
2025-03-07 01:17:44,244 - INFO - F1分数(宏平均): 0.4359
2025-03-07 01:17:44,244 - INFO - F1分数(加权平均): 0.9007
2025-03-07 01:17:44,254 - INFO - 分类报告:
              precision    recall  f1-score   support

         无故障       1.00      0.85      0.92      2896
         HDF       0.36      0.97      0.52        32
         PWF       0.27      1.00      0.42        25
         OSF       0.49      0.93      0.64        28
         TWF       0.06      0.62      0.10        13
         RNF       0.01      0.17      0.01         6

    accuracy                           0.85      3000
   macro avg       0.36      0.75      0.44      3000
weighted avg       0.97      0.85      0.90      3000

2025-03-07 01:17:44,262 - INFO - 二分类准确率: 0.8517
2025-03-07 01:17:44,262 - INFO - 二分类F1分数: 0.3058
2025-03-07 01:17:44,262 - INFO - 二分类精确率: 0.1825
2025-03-07 01:17:44,263 - INFO - 二分类召回率: 0.9423
2025-03-07 01:17:50,075 - INFO - 最佳阈值: 1.0000
2025-03-07 01:17:50,075 - INFO - 最佳阈值下的F1分数: 0.6224
2025-03-07 01:17:50,076 - INFO - 最佳阈值下的精确率: 0.6630
2025-03-07 01:17:50,076 - INFO - 最佳阈值下的召回率: 0.5865
2025-03-07 01:17:50,460 - INFO - 故障类型 HDF 性能:
2025-03-07 01:17:50,460 - INFO -   - 精确率: 0.3563
2025-03-07 01:17:50,460 - INFO -   - 召回率: 0.9688
2025-03-07 01:17:50,460 - INFO -   - F1分数: 0.5210
2025-03-07 01:17:50,460 - INFO -   - 样本数: 32.0
2025-03-07 01:17:50,460 - INFO - 故障类型 PWF 性能:
2025-03-07 01:17:50,461 - INFO -   - 精确率: 0.2660
2025-03-07 01:17:50,461 - INFO -   - 召回率: 1.0000
2025-03-07 01:17:50,461 - INFO -   - F1分数: 0.4202
2025-03-07 01:17:50,461 - INFO -   - 样本数: 25.0
2025-03-07 01:17:50,461 - INFO - 故障类型 OSF 性能:
2025-03-07 01:17:50,461 - INFO -   - 精确率: 0.4906
2025-03-07 01:17:50,461 - INFO -   - 召回率: 0.9286
2025-03-07 01:17:50,461 - INFO -   - F1分数: 0.6420
2025-03-07 01:17:50,461 - INFO -   - 样本数: 28.0
2025-03-07 01:17:50,461 - INFO - 故障类型 TWF 性能:
2025-03-07 01:17:50,462 - INFO -   - 精确率: 0.0563
2025-03-07 01:17:50,462 - INFO -   - 召回率: 0.6154
2025-03-07 01:17:50,462 - INFO -   - F1分数: 0.1032
2025-03-07 01:17:50,462 - INFO -   - 样本数: 13.0
2025-03-07 01:17:50,462 - INFO - 故障类型 RNF 性能:
2025-03-07 01:17:50,462 - INFO -   - 精确率: 0.0062
2025-03-07 01:17:50,462 - INFO -   - 召回率: 0.1667
2025-03-07 01:17:50,462 - INFO -   - F1分数: 0.0120
2025-03-07 01:17:50,462 - INFO -   - 样本数: 6.0
2025-03-07 01:17:50,464 - INFO - 评估结果已保存到 improved_experiment_results\20250307_010142\improved_evaluation_results.json
2025-03-07 01:17:50,464 - INFO - 模型评估完成
2025-03-07 01:17:50,464 - INFO - 实验完成！结果保存在: improved_experiment_results\20250307_010142
2025-03-07 01:17:50,464 - INFO - 准确率: 0.8493
2025-03-07 01:17:50,464 - INFO - F1分数(加权平均): 0.9007
2025-03-07 01:17:50,464 - INFO - 最佳阈值: 1.0000
2025-03-07 01:17:50,464 - INFO - 最佳阈值下的F1分数: 0.6224
2025-03-07 01:17:50,465 - INFO - TWF故障类型性能: {'precision': 0.056338028169014086, 'recall': 0.6153846153846154, 'f1-score': 0.1032258064516129, 'support': 13.0}
2025-03-07 01:17:50,465 - INFO - RNF故障类型性能: {'precision': 0.006211180124223602, 'recall': 0.16666666666666666, 'f1-score': 0.011976047904191617, 'support': 6.0}

进程已结束，退出代码为 0
